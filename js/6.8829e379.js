(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"713b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-layout",{attrs:{view:"lHh Lpr lFf"}},[a("TopToolbar"),a("q-page-container",[a("router-view")],1),a("q-ajax-bar",{ref:"bar",attrs:{position:"bottom",color:"accent",size:"10px","skip-hijack":""}})],1)},i=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-header",{staticClass:"bg-black",attrs:{elevated:"",reveal:""}},[a("q-toolbar",[a("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),a("q-toolbar-title",{staticStyle:{overflow:"visible"}},[a("span",{},[e._v("CONCORDANT.IO")]),e.profile.id?a("q-avatar",{staticClass:"q-ml-lg"},[a("img",{staticClass:"cursor-pointer",attrs:{src:e.profile.avatar_url},on:{click:function(t){return e.showProfile()}}})]):e._e(),e.newMessages?a("q-btn",{staticClass:"q-pa-none q-ml-md",attrs:{round:"",color:"dark",to:"/messages",icon:"email"}},[a("q-badge",{staticStyle:{"font-size":"0.70em"},attrs:{floating:"",color:"accent"}},[e._v("new "+e._s(e.newMessages))])],1):e._e(),e.profile.id?e._e():a("q-btn",{staticClass:"q-ml-lg",staticStyle:{color:"goldenrod"},attrs:{to:"/login",outline:"",label:"Login"}})],1)],1)],1),a("q-drawer",{attrs:{bordered:"",mini:e.miniState,width:200,"content-class":"bg-black text-white"},on:{mouseover:function(t){e.miniState=!1},mouseout:function(t){e.miniState=!0}},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[a("q-list",{staticClass:"q-pt-lg"},[a("MainNav",{staticClass:"q-mt-lg"})],1)],1)],1)},o=[],r=a("c973"),l=a.n(r),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-list",e._l(e.navItems,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.name,attrs:{clickable:"",tag:t.tagType,to:t.href?t.href:null},on:{mouseover:function(t){e.miniState=!1},mouseout:function(t){e.miniState=!0},click:function(e){t.fn&&t.fn()}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:t.iconName}})],1),a("q-item-section",[a("q-item-label",[e._v(e._s(t.text))])],1)],1)})),1)},u=[],h={name:"MainNav",data(){return{navItems:[{tagType:"a",iconName:"home",href:"/",fn:!1,text:"Home"},{tagType:"a",iconName:"article",href:"/treaties",fn:!1,text:"Treaties"},{tagType:"a",iconName:"public",href:"/organizations",fn:!1,text:"Organizations"},{tagType:"a",iconName:"flash_on",href:"/conflicts",fn:!1,text:"Conflicts"},{tagType:"a",iconName:"person",href:"/members",fn:!1,text:"Members"},{tagType:"a",iconName:"email",href:"/messages",fn:!1,text:"Messages"},{tagType:"a",iconName:"login",href:"/login",fn:!1,text:"Login"},{tagType:"a",iconName:"logout",fn:this.logout,text:"Logout"}],active:"Home"}},mounted(){},methods:{logout(){if(this.$store.commit("user/updateUid",null),this.$store.commit("user/updateAvatar",null),null==this.$hello.getAuthResponse("facebook"))return this.$router.push("/"),!1;this.$hello("facebook").logout().then((function(){window.location.href="/"}),(function(e){alert("Signed out error: "+e.error.message)}))},isLoggedIn(){this.$hello("facebook").api("me").then(e=>{})}}},f=h,m=a("2877"),p=Object(m["a"])(f,c,u,!1,null,null,null),g=p.exports,d={name:"TopToolbar",mounted(){this.getProfile("facebook"),this.checkMessages()},created(){this.$store.subscribe((e,t)=>{"user/updateMsgCount"===e.type&&this.checkMessages()})},components:{MainNav:g},data(){return{profile:{},leftDrawerOpen:!1,miniState:!0,newMessages:!1}},methods:{showProfile:function(){this.$router.push({path:"/profile/"+this.$store.state.user.uid})},getProfile:function(e){if(null==this.$hello.getAuthResponse(e))return!1;this.profile.id=this.$store.state.user.uid,this.profile.avatar_url=this.$store.state.user.avatarUrl},checkMessages:function(){var e=l()((function*(){if(this.profile.id){const e=`http://72.177.0.66:3000//user-messages?filter[where][and][0][user_id]=${this.$store.state.user.uid}&filter[where][and][1][status]=0`,t=yield this.$axios.get(e);this.newMessages=t.data.length,this.newMessages&&this.$store.commit("user/updateMsgCount",this.newMessages)}}));return function(){return e.apply(this,arguments)}}()}},b=d,v=Object(m["a"])(b,n,o,!1,null,null,null),w=v.exports,q={name:"MainLayout",components:{TopToolbar:w},data(){return{prevHeight:0}},methods:{beforeLeave(e){this.prevHeight=getComputedStyle(e).height},enter(e){const{height:t}=getComputedStyle(e);e.style.height=this.prevHeight,setTimeout(()=>{e.style.height=t})},afterEnter(e){e.style.height="auto"}}},y=q,k=Object(m["a"])(y,s,i,!1,null,null,null);t["default"]=k.exports}}]);