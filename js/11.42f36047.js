(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{6346:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"full-height river-width"},[t.conflict_creator_user_id?a("ConflictHeaderSection",{attrs:{creatorUserId:t.conflict_creator_user_id,name:t.name,avatar_url:t.avatar_url,description:t.description,status:t.status,id:t.id,reload:t.reload,org_a:t.org_a,org_b:t.org_b,user_organization_name:t.user_organization_name}}):t._e(),a("q-separator"),t.loading?t._e():a("ConflictPanelsSection",{key:t.counter,attrs:{userOrganizationId:t.user_organization_id,orgA:t.org_a,orgB:t.org_b,conflictId:t.conflictId,title:t.name,reload:t.reload}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.verify_org,callback:function(e){t.verify_org=e},expression:"verify_org"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"done_outline",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[t._v("Choose ONE organization to comment as.")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_a.name,color:"primary"},on:{click:function(e){return t.setOrg(t.org_a)}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_b.name,color:"primary"},on:{click:function(e){return t.setOrg(t.org_b)}}})],1)],1)],1)],1)},r=[],n=(a("e01a"),a("c973")),o=a.n(n),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"row full-width q-pa-sm bg-grey-2"},[a("div",{staticClass:"col col-md-5"},[a("a",{staticClass:"cursor-pointer",on:{click:function(e){return t.$router.push("/organization/"+t.org_a.id)}}},[a("q-avatar",{attrs:{size:"40px",square:""}},[a("q-img",{staticClass:"q-mt-none",attrs:{rounded:"",src:t.org_a.avatar_url}})],1),a("br"),t._v("\n          "+t._s(t.org_a.name)+"\n      ")],1)]),a("div",{staticClass:"col col-md-2 text-center q-pt-md"},[t._v("\n      vs.\n    ")]),a("div",{staticClass:"col col-md-5 text-right"},[a("a",{staticClass:"cursor-pointer",on:{click:function(e){return t.$router.push("/organization/"+t.org_b.id)}}},[a("q-avatar",{attrs:{size:"40px",square:""}},[a("q-img",{staticClass:"q-mt-none",attrs:{rounded:"",src:t.org_b.avatar_url}})],1),a("br"),t._v("\n          "+t._s(t.org_b.name)+"\n      ")],1)])]),a("q-card",{staticClass:"q-pl-lg q-pr-lg full-width full-height"},[a("div",{staticClass:"row relative-position full-width",staticStyle:{height:"40px"}},[t.isUser?a("q-expansion-item",{staticClass:"absolute-right z-100",attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Edit Conflict"},model:{value:t.expanded,callback:function(e){t.expanded=e},expression:"expanded"}},[a("EditConflictWidget",{attrs:{name:t.name,avatar_url:t.avatar_url,description:t.description,status:t.status,id:t.id,reload:t.reloadComponent}})],1):t._e()],1),a("q-card-section",{staticClass:"full-width items-start q-pb-lg",attrs:{horizontal:""}},[a("q-img",{staticStyle:{"max-width":"50%","max-height":"250px"},attrs:{src:t.avatar_url}}),a("q-card-section",{staticClass:"q-pb-md q-pt-none",staticStyle:{width:"50%"}},[a("h5",{staticClass:"q-pt-none"},[t._v(t._s(t.name))]),a("p",{staticClass:"q-pt-none"},[t._v(t._s(t.description))]),a("div",{staticClass:"row"},[t.user_organization_name?a("q-badge",{attrs:{color:"secondary",label:"Commenting as: "+t.user_organization_name}}):t._e()],1)])],1)],1)],1)},l=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dialog-width"},[a("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[a("q-input",{attrs:{filled:"","stack-label":"",label:"Name"},on:{input:t.handleInput},model:{value:t.data_name,callback:function(e){t.data_name=e},expression:"data_name"}}),a("q-separator"),a("q-input",{attrs:{filled:"","stack-label":"",label:"Description",name:"description",type:"textarea",autogrow:""},on:{input:t.handleInput},model:{value:t.data_description,callback:function(e){t.data_description=e},expression:"data_description"}}),a("q-separator"),a("q-input",{attrs:{filled:"","stack-label":"",name:"avatar_url",label:"Avatar URL",type:"url"},on:{input:t.handleInput},model:{value:t.data_avatar_url,callback:function(e){t.data_avatar_url=e},expression:"data_avatar_url"}}),a("div",{staticClass:"full-width  text-right q-mt-md"},[a("q-btn",{attrs:{label:"SUBMIT",type:"submit",color:"primary"}})],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this conflict?")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteConflict}})],1)],1)],1)],1)},d=[],p={name:"EditConflictWidget",props:["name","description","avatar_url","id","status","reload"],model:{prop:"name",event:"blur"},watch:{name(t){this.data_name=t},description(t){this.data_description=t},avatar_url(t){this.data_avatar_url=t}},data(){return{data_name:this.name,data_description:this.description,data_avatar_url:this.avatar_url,confirm:!1}},mounted(){this.data_name=this.name,this.$mount()},methods:{deleteConflict:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/conflicts/"+this.id;yield this.$axios.delete(t).then(t=>{this.confirm=!1,this.pageReload(),this.$q.notify({type:"positive",message:"Delete Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error deleting: "+t})})}));return function(){return t.apply(this,arguments)}}(),handleInput(t){this.$emit("msgChange",t)},postForm:function(){var t=o()((function*(t){if(!this.$errorHandler.loggedInCheck())return!1;const e={name:this.data_name,description:this.data_description,avatar_url:this.data_avatar_url},a="https://concordant-api.herokuapp.com/conflicts/"+this.id;yield this.$axios.patch(a,e,{headers:{Accept:"application/json"}}).then(t=>{this.reload(),this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving: "+t})})}));return function(e){return t.apply(this,arguments)}}()}},u=p,m=a("2877"),h=Object(m["a"])(u,c,d,!1,null,null,null),g=h.exports,f={name:"ConflictHeaderSection",props:["name","avatar_url","description","status","id","reload","user_organization_name","org_a","org_b","creatorUserId"],components:{EditConflictWidget:g},data(){return{expanded:!1,isUser:!1}},methods:{reloadComponent(){this.expanded=!1,this.reload()}},created(){this.isUser=this.$errorHandler.isLoggedInUser(this.creatorUserId)}},_=f,b=Object(m["a"])(_,s,l,!1,null,null,null),v=b.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-ma-none"},[a("q-tabs",{key:"tabs"+t.counter,staticClass:"q-mb-sm text-grey-7 bg-grey-4",attrs:{dense:"","active-color":"black","indicator-color":"purple",align:"left"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"activity",label:"Activity "+t.numActivity}}),a("q-tab",{attrs:{name:"topics",label:"Topics "+t.numTopics}}),a("q-tab",{attrs:{name:"grievances",label:"Grievances "+t.numGrievances}}),a("q-tab",{attrs:{name:"offers",label:"Offers "+t.numOffers}}),a("q-tab",{attrs:{name:"treaties",label:"Treaties "+t.numTreaties}})],1),a("q-tab-panels",{staticClass:"full-width q-pa-none q-mb-none",attrs:{animated:"","transition-prev":"fade","transition-next":"fade"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{staticClass:"q-pa-none bg-grey-2",attrs:{name:"grievances"}},[a("p",{staticClass:"q-pa-md q-ma-none"},[t._v("List your organization's grievances or issues with the opposing group here. Please limit each grievance to one entry each. Be as specific and direct as possible. Comment on grievances and rate the importance by voting thumbs up or down on each entry.")]),a("ConflictEntitySection",{key:"g"+t.counter,attrs:{reload:t.reloadPanel,userOrganizationId:t.userOrganizationId,entityType:"grievance",orgA:t.orgA,orgB:t.orgB,conflictId:t.conflictId}})],1),a("q-tab-panel",{staticClass:"q-pa-none bg-grey-2",attrs:{name:"offers"}},[a("p",{staticClass:"q-pa-md q-ma-none"},[t._v("List offers or concessions you think your organization should make here. Please limit each offer to one entry each. Be as specific and direct as possible. Comment on offers and rate the importance by voting thumbs up or down on each entry.")]),a("ConflictEntitySection",{key:"o"+t.counter,attrs:{reload:t.reloadPanel,userOrganizationId:t.userOrganizationId,entityType:"offer",orgA:t.orgA,orgB:t.orgB,conflictId:t.conflictId}})],1),a("q-tab-panel",{staticClass:"q-pa-none bg-grey-2",attrs:{name:"treaties"}},[a("p",{staticClass:"q-pa-md q-ma-none"},[t._v("Treaties are the ultimate purpose of this website. Every treaty consists of provisions. These are points that all parties are willing to agree to which bring both organizations closer to the goal of reconciliation. Click the row to open treaty.")]),a("TreatyTableComponent",{attrs:{conflictId:t.conflictId,orgAname:t.orgA.name,orgBname:t.orgB.name,userOrganizationId:t.userOrganizationId}})],1),a("q-tab-panel",{staticClass:"q-pa-none bg-grey-2",attrs:{name:"topics"}},[a("p",{staticClass:"q-pa-md q-ma-none"},[t._v("Create a new topic to discuss here. Comment on existing topics, share your thoughts and ideas. Please be civil and keep all comments relevant to this conflict between "+t._s(t.orgA.name)+" and "+t._s(t.orgB.name)+". Keep each entry specific and direct. Click on row to open conversation.")]),a("DebateTableComponent",{attrs:{conflictId:t.conflictId,userOrganizationId:t.userOrganizationId}})],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"activity"}},[a("ActivityListPage",{attrs:{title:t.title,entityType:"conflict",entityId:t.conflictId}})],1)],1)],1)])},q=[],C=a("8a18"),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("AddConflictItem",{attrs:{entityType:t.entityType,userOrganizationId:t.userOrganizationId,conflictId:t.conflictId,orgA:t.orgA,orgB:t.orgB,reload:t.reload}}),a("q-table",{attrs:{data:t.sortedData,columns:t.columns,"row-key":"id"},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"organization",attrs:{props:e}},[a("q-avatar",{staticClass:"q-mr-sm",attrs:{round:"",size:"sm"}},[a("img",{attrs:{src:e.row.creator_organization_avatar}})]),a("router-link",{attrs:{to:"/organization/"+e.row.creator_organization_id}},[t._v(t._s(e.row.creator_organization_name))])],1),a("q-td",{key:"title",staticClass:"wrap",attrs:{props:e}},[a("p",{staticClass:"q-pa-none q-ma-none"},[t._v(t._s(e.row.title))]),a("p",{staticClass:"q-pa-none q-ma-none text-caption"},[t._v("created by: "),a("router-link",{attrs:{to:"/profile/"+e.row.creator_id}},[t._v(t._s(e.row.creator_name))]),t._v(" "+t._s(e.row.create_date)+"\n            "),t.userCheck(e.row.creator_id)?a("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer",attrs:{name:"edit",clickable:"",size:"13px"},on:{click:function(a){return t.editEntity(e.row.id,e.row.title)}}}):t._e(),t.userCheck(e.row.creator_id)?a("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer",attrs:{name:"delete",clickable:"",size:"13px"},on:{click:function(a){return t.promptDelete(e.row.id)}}}):t._e()],1)]),a("q-td",{attrs:{"auto-width":""}},[a("LikeButtons",{attrs:{entityType:"grievance",entityId:e.row.id,readonly:!t.orgVerify(t.orgA.id),organizationId:t.orgA.id}})],1),a("q-td",{attrs:{"auto-width":""}},[a("LikeButtons",{attrs:{entityType:"grievance",entityId:e.row.id,readonly:!t.orgVerify(t.orgB.id),organizationId:t.orgB.id}})],1)],1),a("q-tr",{staticClass:"sub-row",attrs:{props:e}},[a("q-td",{attrs:{colspan:"100%"}},[a("CommentsWidget",{attrs:{entityId:e.row.id,entityType:t.entityType,userOrganizationId:t.userOrganizationId}})],1)],1)]}}])}),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this "+t._s(t.entityType)+"?")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteEntity}})],1)],1)],1),a("q-dialog",{model:{value:t.confirmEdit,callback:function(e){t.confirmEdit=e},expression:"confirmEdit"}},[a("EditConflictItem",{attrs:{reload:t.getData,editId:t.editId,entityType:t.entityType,editTitle:t.editTitle}})],1)],1)},x=[],w=(a("26e9"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",{attrs:{color:"secondary"}},[a("div",{staticClass:"text-h6 capitalize"},[t._v("Edit "+t._s(t.entityType)+"-"+t._s(t.editId))])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-input",{attrs:{autogrow:"",required:"",dense:"",maxlength:"100",value:t.editTitle,label:"Title"},model:{value:t.data_editTitle,callback:function(e){t.data_editTitle=e},expression:"data_editTitle"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"SUBMIT"},on:{click:t.submitForm}})],1)],1)],1)}),I=[],z={meta(){return{}},name:"EditConflictItem",props:["editId","entityType","editTitle","reload"],data(){return{data_editTitle:this.editTitle}},methods:{submitForm:function(){var t=o()((function*(){const t={title:this.data_editTitle},e=`https://concordant-api.herokuapp.com/${this.entityType}s/${this.editId}`;yield this.$axios.patch(e,t).then(t=>{this.reload(),this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error updating: "+t})})}));return function(){return t.apply(this,arguments)}}()},mounted(){}},T=z,$=Object(m["a"])(T,w,I,!1,null,null,null),D=$.exports,O=a("3cc5"),E=a("9088"),A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{staticClass:"full-width",attrs:{color:"accent",label:"Add "+t.entityType},on:{click:t.openForm}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",{attrs:{color:"secondary"}},[a("div",{staticClass:"text-h6 capitalize"},[t._v("Add "+t._s(t.entityType))])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-select",{attrs:{options:t.options,required:"",label:"Organization"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),a("q-input",{attrs:{autogrow:"",required:"",dense:"",maxlength:"100",hint:t.charsRemain+" characters",label:"Title"},on:{keyup:t.updateCount},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"CANCEL"},on:{click:t.clearForm}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"SUBMIT"},on:{click:t.submitForm}})],1)],1)],1)],1)},S=[],N=a("cf1f"),j={name:"AddConflictItem",data(){return{prompt:!1,title:"",description:"",type:"",options:[{label:this.orgA.name,value:this.orgA.id},{label:this.orgB.name,value:this.orgB.id}],charsRemain:100,maxChars:100}},mixins:[N["a"]],mounted(){},props:["entityType","conflictId","reload","userOrganizationId","orgA","orgB"],methods:{updateCount:function(){this.charsRemain=this.maxChars-this.title.length},openForm:function(){if(!this.$errorHandler.organizationCheck(this.userOrganizationId))return!1;this.title="",this.description="",this.prompt=!0},clearForm:function(){this.title="",this.type="",this.charsRemain=this.maxChars,this.description=""},submitForm:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType.toLowerCase()}s`,e={creator_user_id:this.$store.state.user.uid,creator_organization_id:this.userOrganizationId,title:this.title,organization_id:this.type.value,conflict_id:this.conflictId};yield this.$axios.post(t,e,{headers:{Accept:"application/json"}});const a="grievance"===this.entityType?"Grievance Maker":"Offer Maker";this.addAchievement(a),this.clearForm(),this.reload()}));return function(){return t.apply(this,arguments)}}()}},B=j,R=Object(m["a"])(B,A,S,!1,null,null,null),L=R.exports,P=a("b178"),F={name:"ConflictEntitySection",props:["userOrganizationId","orgA","orgB","conflictId","entityType","reload"],components:{AddConflictItem:L,CommentsWidget:E["a"],LikeButtons:O["a"],EditConflictItem:D},data(){return{confirmDelete:!1,confirmEdit:!1,deleteId:null,editId:null,editTitle:null,filter:"",entities:[],title:"",columns:[{name:"organization",align:"left",label:"Organization",field:"creator_organization_name",sortable:!0},{name:"title",align:"left",label:this.entityType,field:"title"},{name:"orgA",align:"left",label:this.orgA.name},{name:"orgB",align:"left",label:this.orgB.name}]}},computed:{sortedData:function(){return this.entities.map(t=>("object"!==typeof t.likes&&(t.likes=[]),{id:t.id,conflict_id:t.conflict_id,create_date:P["b"].formatDate(t.create_date,"M/D/YY"),description:t.description,title:t.title,creator_organization_name:t.organization.name,creator_organization_avatar:t.organization.avatar_url,creator_organization_id:t.organization.id,creator_name:t.creator.name,creator_id:t.creator.id,creator_avatar:t.creator.avatar_url,creator_location:t.creator.location,likes:t.likes.map(t=>({liked:t.liked,creator_organization_name:t.organization.name,creator_name:t.creator.name,creator_avatar:t.creator.avatar_url}))})).reverse()}},methods:{deleteEntity:function(){var t=o()((function*(){this.confirm=!1;const t=`https://concordant-api.herokuapp.com/${this.entityType}s/${this.deleteId}/${this.entityType}-comments`,e=`https://concordant-api.herokuapp.com/${this.entityType}s/${this.deleteId}/${this.entityType}-likes`,a=`https://concordant-api.herokuapp.com/${this.entityType}s/${this.deleteId}`,i=this,r=[t,e,a];for(let o=0;o<r.length;o++)n(r[o],o);function n(t,e){return s.apply(this,arguments)}function s(){return s=o()((function*(t,e){yield i.$axios.delete(t).then(t=>{2===e&&(i.reload(),i.$q.notify({type:"positive",message:"Delete Success"}))}).catch(t=>{i.$q.notify({type:"negative",message:"Error updating: "+t})})})),s.apply(this,arguments)}}));return function(){return t.apply(this,arguments)}}(),promptDelete:function(t){this.deleteId=t,this.confirmDelete=!0},editEntity:function(t,e){this.editId=t,this.editTitle=e,this.confirmEdit=!0},orgVerify:function(t){return t===this.userOrganizationId},userCheck:function(t){return this.$errorHandler.isLoggedInUser(t)},getData:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}s/?filter={"where": {"conflict_id":"${this.conflictId}"}, "include": [{"relation": "organization"}, {"relation": "creator"}, {"relation": "likes", "scope":{"include":[{"relation":"organization"}, {"relation":"creator"}]}}]}`,e=yield this.$axios.get(t);this.entities=e.data}));return function(){return t.apply(this,arguments)}}()},created(){this.getData()}},U=F,M=Object(m["a"])(U,k,x,!1,null,null,null),Y=M.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{staticClass:"full-width text-center",attrs:{color:"accent"},on:{click:t.openCreateTreaty}},[t._v("Add Treaty")]),a("div",{staticClass:"row full-width"},[a("q-table",{staticClass:"full-width align-left table",attrs:{dense:"",flat:"",data:t.treaties,columns:t.columns,"row-key":"id",pagination:t.initialPagination},on:{"row-click":t.onRowClick},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0}])}),a("q-dialog",{staticClass:"z-top",model:{value:t.showTreaty,callback:function(e){t.showTreaty=e},expression:"showTreaty"}},[a("TreatyDialogComponent",{staticClass:"z-top",attrs:{creatorName:t.creatorName,creatorId:t.creatorId,orgAname:t.orgAname,orgBname:t.orgBname,userOrganizationId:t.userOrganizationId,treatyId:t.childTreatyId}})],1),a("q-dialog",{staticClass:"z-top",model:{value:t.createTreaty,callback:function(e){t.createTreaty=e},expression:"createTreaty"}},[a("q-layout",{staticClass:"bg-white river-width",attrs:{view:"Lhh lpR fff",container:""}},[a("q-header",{staticClass:"bg-grey"},[a("q-toolbar",[a("q-toolbar-title",{staticClass:"text-center"},[t._v("Create Treaty")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),a("q-page-container",[a("CreateTreaty",{attrs:{userOrganizationId:t.userOrganizationId,conflictId:t.conflictId,reload:t.reload}})],1)],1)],1)],1)],1)},H=[],V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{staticClass:"q-pa-none bg-white",attrs:{view:"Lhh lpR fff",container:""}},[a("q-header",{staticClass:"bg-grey"},[a("q-toolbar",[a("q-toolbar-title",{staticClass:"q-pl-lg text-center"},[t._v("CONCORDANT.IO TREATY")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),a("TreatyPage",{attrs:{treatyId:t.treatyId}})],1)},G=[],K=a("295b"),J={name:"TreatyDialogComponent",meta(){return{title:this.treatyName}},props:["treatyId"],components:{TreatyPage:K["default"]},created(){}},Q=J,X=Object(m["a"])(Q,V,G,!1,null,null,null),Z=X.exports,tt=a("95fb"),et={name:"TreatyTableComponent",components:{TreatyDialogComponent:Z,CreateTreaty:tt["a"]},props:["userOrganizationId","conflictId","orgAname","orgBname"],data(){return{filter:"",treaties:[],childTreatyId:null,creatorName:null,creatorId:null,pointer:0,limit:9,createTreaty:!1,showTreaty:!1,done:!1,loadNum:0,columns:[],initialPagination:{sortBy:"desc",descending:!0,page:1,rowsPerPage:100}}},methods:{openCreateTreaty:function(){if(!this.$errorHandler.organizationCheck(this.userOrganizationId))return!1;this.createTreaty=!0},reload:function(){this.treaties=[],this.createTreaty=!1,this.getTreaties()},onRowClick:function(t,e){this.openTreaty(e)},openTreaty:function(t){this.creatorId=t.creatorId,this.creatorName=t.creatorName,this.childTreatyId=t.id,this.showTreaty=!0},getTreaties:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/treaties?filter[where][conflict_id]=${this.conflictId}&filter[limit]=${this.limit}&filter[skip]=${this.pointer}&filter[include][][relation]=status&filter[include][1][relation]=creator&filter[include][2][relation]=organization&filter[order]=create_date%20DESC`,e=yield this.$axios.get(t);this.limit>e.data.length&&(this.done=!0);const a=e.data.map(t=>({id:t.id,avatar_url:t.avatar_url,create_date:t.create_date,name:t.name,description:t.description,status:t.status.name,creatorId:t.creator.id,creatorName:t.creator.name,organization_id:t.organization.id,organization:t.organization.name}));this.treaties=this.treaties.concat(a)}));return function(){return t.apply(this,arguments)}}(),setupTable:function(){this.columns=[{name:"name",label:"Name",field:"name",align:"left"},{name:"organization",label:"Organization",field:"organization",sortable:!0,align:"left"},{name:"creatorName",label:"Creator",field:"creatorName",sortable:!0,align:"left"},{name:"create_date",label:"Date",field:"create_date",sortable:!0,align:"left",format:t=>P["b"].formatDate(t,"M/D/YY")}]}},mounted(){this.getTreaties(),this.setupTable()}},at=et,it=Object(m["a"])(at,W,H,!1,null,null,null),rt=it.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("CreateDebateWidget",{attrs:{conflictId:t.conflictId,userOrganizationId:t.userOrganizationId,reload:t.reload}}),a("div",{staticClass:"row full-width"},[a("q-table",{staticClass:"full-width align-left table",attrs:{dense:"",flat:"",loading:t.loading,data:t.readyDebates,columns:t.columns,"row-key":"id",pagination:t.initialPagination},on:{"row-click":t.onRowClick},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0}])})],1),a("q-dialog",{staticClass:"z-top",model:{value:t.showDebate,callback:function(e){t.showDebate=e},expression:"showDebate"}},[a("DebateDialogComponent",{staticClass:"z-top",attrs:{userOrganizationId:t.userOrganizationId,pageReload:t.reload,debateId:t.childDebateId}})],1)],1)},ot=[],st=(a("fb6a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{staticClass:"bg-white full-width",attrs:{view:"Lhh lpR fff",container:""}},[a("q-header",{staticClass:"z-max bg-grey"},[a("q-toolbar",[a("q-toolbar-title",{staticClass:"q-pl-lg text-center"},[t._v("CONCORDANT.IO")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),a("q-page-container",[a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row relative-position full-width",staticStyle:{height:"35px"}},[a("q-expansion-item",{staticClass:"absolute-right z-100",attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Edit Debate"},model:{value:t.expanded,callback:function(e){t.expanded=e},expression:"expanded"}},[a("EditDebateWidget",{attrs:{title:t.debate.title,avatar_url:t.debate.avatar_url,description:t.debate.description,id:t.debate.id,reload:t.reload,pageReload:t.pageReload}})],1)],1),a("div",{staticClass:"q-pt-sm full-width q-mb-lg"},[a("q-img",{staticClass:"q-mb-lg",attrs:{src:t.debate.avatar_url}})],1),a("div",{staticClass:"row q-pr-lg q-mt-lg q-mb-lg"},[a("div",{staticClass:"col col-2"},[a("q-avatar",{staticClass:"comment-q-avatar",attrs:{round:""}},[t.debate.creator?a("img",{attrs:{src:t.debate.creator.avatar_url}}):t._e()])],1),a("div",{staticClass:"col p-pl-lg"},[a("div",[t._v(t._s(t.readyDate))]),t.debate.creator?a("p",{staticClass:"text-h5 q-pa-none q-ma-none"},[t._v(t._s(t.debate.creator.name)+":")]):t._e(),a("h6",{staticClass:"q-pa-none"},[t._v(t._s(t.debate.title))]),a("p",{staticClass:"q-pt-none"},[t._v(t._s(t.debate.description))])])]),a("q-separator"),a("div",{staticClass:"row"},[a("q-expansion-item",{staticClass:"full-width bg-grey-5 q-mb-lg text-right",staticStyle:{"z-index":"5"},attrs:{"dense-toggle":"",label:"Add Response"},model:{value:t.add_reply[0],callback:function(e){t.$set(t.add_reply,0,e)},expression:"add_reply[0]"}},[a("AddDebateComment",{attrs:{debateId:t.debate.id,parentId:"0",reload:t.reload}})],1)],1),t._l(t.debate.topComments,(function(e){return a("div",{key:e.id,staticClass:"q-mb-lg"},[a("div",{staticClass:"row q-pr-lg"},[a("div",{staticClass:"col col-2"},[a("q-avatar",{staticClass:"comment-q-avatar",attrs:{round:""}},[a("img",{attrs:{src:e.creator.avatar_url}})])],1),a("div",{staticClass:"col p-pa-none"},[a("div",{staticClass:"float-right"},[t._v("\n           "+t._s(t.comment_likes_amounts[e.id])+" "),a("q-rating",{attrs:{max:"1",size:"1.75em",color:"red","color-selected":"red-12",icon:"favorite_border","icon-selected":"favorite","icon-half":"favorite","no-dimming":""},on:{click:function(a){return t.like(e.id)}},model:{value:t.user_comment_likes[e.id],callback:function(a){t.$set(t.user_comment_likes,e.id,a)},expression:"user_comment_likes[comment.id]"}})],1),a("div",{staticClass:"text-small"},[t._v(t._s(e.create_date))]),a("p",{staticClass:"text-h5 q-pa-none"},[t._v(t._s(e.creator.name)+":")]),a("p",{staticClass:"q-pt-none"},[t._v(t._s(e.text))])])]),a("div",{staticClass:"row"},[a("q-expansion-item",{staticClass:"full-width bg-blue-4 text-right q-mt-md q-pb-lg",staticStyle:{"z-index":"4"},attrs:{"dense-toggle":"",label:"reply"},model:{value:t.add_reply[e.id],callback:function(a){t.$set(t.add_reply,e.id,a)},expression:"add_reply[comment.id]"}},[a("AddDebateComment",{attrs:{debateId:t.debate.id,parentId:e.id,reload:t.reload}}),a("q-separator")],1)],1),t.debate.childKeys.indexOf(e.id)>-1?a("q-expansion-item",{staticClass:"text-right bg-grey-4 q-mb-md",attrs:{label:"replies "+t.debate.childComments[e.id].length}},t._l(t.debate.childComments[e.id],(function(i){return a("div",{key:i.id,staticClass:"q-pl-lg q-pb-lg"},[a("div",{staticClass:"row text-left bg-grey-4 q-pr-lg q-pb-lg"},[a("div",{staticClass:"col col-2 text-center"},[a("q-avatar",{staticClass:"comment-q-avatar-inner",attrs:{round:""}},[a("img",{attrs:{src:e.creator.avatar_url}})])],1),a("div",{staticClass:"col p-pa-none"},[a("div",{staticClass:"float-right"},[t._v("\n              "+t._s(t.comment_likes_amounts[i.id])+" "),a("q-rating",{attrs:{max:"1",size:"1.75em",color:"red","color-selected":"red-12",icon:"favorite_border","icon-selected":"favorite","icon-half":"favorite","no-dimming":""},on:{click:function(e){return t.like(i.id)}},model:{value:t.user_comment_likes[i.id],callback:function(e){t.$set(t.user_comment_likes,i.id,e)},expression:"user_comment_likes[commentInner.id]"}})],1),a("div",[t._v(t._s(i.create_date))]),a("p",{staticClass:"text-h6 align-left q-pa-none "},[t._v(t._s(i.creator.name)+" replies:")]),a("p",{staticClass:"q-pt-none q-pr-md align-left"},[t._v(t._s(i.text))])])]),a("q-separator")],1)})),0):t._e()],1)}))],2)],1)],1)}),lt=[],ct=(a("4e82"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-width"},[a("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[a("q-input",{attrs:{filled:"","stack-label":"",label:"Title"},on:{input:t.handleInput},model:{value:t.data_title,callback:function(e){t.data_title=e},expression:"data_title"}}),a("q-separator"),a("q-input",{attrs:{filled:"","stack-label":"",label:"description",title:"description",type:"textarea",autogrow:""},on:{input:t.handleInput},model:{value:t.data_description,callback:function(e){t.data_description=e},expression:"data_description"}}),a("q-separator"),a("q-input",{attrs:{filled:"","stack-label":"",title:"avatar_url",label:"Avatar URL",type:"url"},on:{input:t.handleInput},model:{value:t.data_avatar_url,callback:function(e){t.data_avatar_url=e},expression:"data_avatar_url"}}),a("div",{staticClass:"full-width  text-right q-mt-md"},[a("q-btn",{attrs:{label:"SUBMIT",type:"submit",color:"primary"}})],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this debate?")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteDebate}})],1)],1)],1)],1)}),dt=[],pt={title:"EditDebateWidget",props:["title","description","avatar_url","id","reload","pageReload"],model:{prop:"title",event:"blur"},watch:{title(t){this.data_title=t},description(t){this.data_description=t},avatar_url(t){this.data_avatar_url=t}},data(){return{data_title:this.title,data_description:this.description,data_avatar_url:this.avatar_url,confirm:!1}},mounted(){this.data_title=this.title,this.$mount()},methods:{deleteDebate:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/debates/"+this.id;yield this.$axios.delete(t).then(t=>{this.confirm=!1,this.pageReload(),this.$q.notify({type:"positive",message:"Delete Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error deleting: "+t})})}));return function(){return t.apply(this,arguments)}}(),handleInput:function(t){this.$emit("msgChange",t)},postForm:function(){var t=o()((function*(t){const e={title:this.data_title,description:this.data_description,avatar_url:this.data_avatar_url},a="https://concordant-api.herokuapp.com/debates/"+this.id;yield this.$axios.patch(a,e,{headers:{Accept:"application/json"}}).then(t=>{this.reload(),this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving: "+t})})}));return function(e){return t.apply(this,arguments)}}()}},ut=pt,mt=Object(m["a"])(ut,ct,dt,!1,null,null,null),ht=mt.exports,gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postComment}},[a("q-input",{attrs:{label:"Message",autogrow:""},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),a("div",{staticClass:"full-width row"},[a("div",{staticClass:"text-right col q-mt-lg"},[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}})],1)])],1)},ft=[],_t={name:"AddDebateComment",props:["debateId","parentId","reload"],data(){return{text:""}},methods:{postComment:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/debate-comments",e={text:this.text,creator_user_id:this.$store.state.user.uid,debate_id:this.debateId,parent_comment_id:parseInt(this.parentId)};yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}).then(()=>{this.$q.notify({type:"positive",message:"Comment Saved"}),this.reload(),this.text=""}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving debate comment: "+t})})}));return function(){return t.apply(this,arguments)}}()},mounted(){}},bt=_t,vt=Object(m["a"])(bt,gt,ft,!1,null,null,null),yt=vt.exports,qt=a("c80c"),Ct={name:"DebateDialogComponent",mixins:[qt["a"]],props:["debateId","userOrganizationId","pageReload"],components:{AddDebateComment:yt,EditDebateWidget:ht},data(){return{expanded:!1,comments:[],debate:{},add_reply:[],user_comment_likes:{},comment_likes_amounts:{},comment_likes_obj:{}}},created(){this.getDebate()},computed:{readyDate:function(){return P["b"].formatDate(this.debate.create_date,"MMM Do, YYYY")},readyComments:function(){return this.debate.comments.map(t=>(t.text=this.checkStr(t.text),t.create_date=P["b"].formatDate(t.create_date,"MMM Do, YYYY"),t))}},methods:{like:function(){var t=o()((function*(t){let e="",a="";const i={organization_id:this.userOrganizationId,creator_user_id:this.$store.state.user.uid,liked:this.user_comment_likes[t],debate_comment_id:t};"object"===typeof this.comment_likes_obj[t]?(e="https://concordant-api.herokuapp.com/debate-comment-likes/"+this.comment_likes_obj[t][0].id,a="patch"):(e="https://concordant-api.herokuapp.com/debate-comment-likes",a="post"),yield this.$axios[a](e,i,{headers:{Accept:"application/json"}}).then(t=>{this.reload(),this.$q.notify({type:"positive",message:"Like Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving: "+t})})}));return function(e){return t.apply(this,arguments)}}(),reload:function(){this.expanded=!1,this.getDebate();for(let t=0;t<this.add_reply.length;t++)this.add_reply[t]=!1},getDebate:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/debates/${this.debateId}?filter={"include":[{"relation":"creator"}, {"relation":"comments", "scope":{"include":[{"relation":"creator"}, {"relation":"likes"}]}}], "order": "create_date ASC"}`,e=yield this.$axios.get(t);this.debate=e.data,this.debate.comments&&(this.setupLikes(),this.sortComments())}));return function(){return t.apply(this,arguments)}}(),setupLikes:function(){for(let t=0;t<this.debate.comments.length;t++){const e="object"===typeof this.debate.comments[t].likes?this.debate.comments[t].likes.filter(t=>t.creator_user_id===this.$store.state.user.uid).map(t=>t.liked):[];this.user_comment_likes[this.debate.comments[t].id]="number"===typeof e[e.length-1]?e[e.length-1]:0,this.comment_likes_amounts[this.debate.comments[t].id]="object"===typeof this.debate.comments[t].likes?this.debate.comments[t].likes.filter(t=>1===t.liked).length:0,"object"===typeof this.debate.comments[t].likes&&(this.comment_likes_obj[this.debate.comments[t].id]=this.debate.comments[t].likes.filter(t=>t.creator_user_id===this.$store.state.user.uid))}},sortComments:function(){const t=this.readyComments.filter(t=>t.parent_comment_id);this.debate.childComments={},this.debate.childKeys=[],this.debate.topComments=this.readyComments.filter(t=>!t.parent_comment_id),this.debate.topComments.sort((t,e)=>t.create_date<e.create_date?1:-1);for(let e=0;e<t.length;e++)"object"!==typeof this.debate.childComments[t[e].parent_comment_id]&&(this.debate.childComments[t[e].parent_comment_id]=[]),this.debate.childComments[t[e].parent_comment_id].push(t[e]),this.debate.childKeys.push(t[e].parent_comment_id)}}},kt=Ct,xt=Object(m["a"])(kt,st,lt,!1,null,null,null),wt=xt.exports,It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{staticClass:"full-width",attrs:{color:"accent",label:"Add Topic"},on:{click:t.openForm}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",{attrs:{color:"secondary"}},[a("div",{staticClass:"text-h6 capitalize"},[t._v("Add Topic")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-input",{attrs:{dense:"",required:"",placeholder:"Title"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("q-input",{attrs:{dense:"",required:"",placeholder:"Description",autogrow:"",type:"textarea"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),a("q-input",{attrs:{dense:"",placeholder:"Avatar URL",type:"url"},model:{value:t.avatar_url,callback:function(e){t.avatar_url=e},expression:"avatar_url"}}),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"CANCEL"},on:{click:t.clearForm}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"SUBMIT"},on:{click:t.postForm}})],1)],1)],1)],1)],1)},zt=[],Tt={name:"CreateDebateWidget",props:["userOrganizationId","conflictId","reload"],data(){return{title:"",description:"",avatar_url:"",prompt:!1}},methods:{openForm:function(){this.title="",this.description="",this.avatar_url="",this.prompt=!0},clearForm:function(){this.title="",this.avatar_url="",this.description=""},postForm:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/debates",e={creator_user_id:this.$store.state.user.uid,creator_organization_id:this.userOrganizationId,description:this.description,avatar_url:this.avatar_url,title:this.title,conflict_id:this.conflictId};yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}).then(t=>{this.clear(),this.reload(),this.$q.notify({type:"positive",message:"Debate Created"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error adding debate: "+t})})}));return function(){return t.apply(this,arguments)}}(),clear:function(){this.description="",this.title="",this.avatar_url=""}}},$t=Tt,Dt=Object(m["a"])($t,It,zt,!1,null,null,null),Ot=Dt.exports,Et={name:"DebateTableComponent",props:["userOrganizationId","conflictId"],components:{CreateDebateWidget:Ot,DebateDialogComponent:wt},data(){return{filter:"",expanded:!1,childDebateId:null,debates:[],pointer:0,limit:15,done:!1,loading:!1,loadNum:0,columns:[],showDebate:!1,initialPagination:{sortBy:"desc",descending:!0,page:1,rowsPerPage:100}}},mounted(){},created(){var t=this;return o()((function*(){t.loadDebates(),t.setupTable()}))()},computed:{readyDebates:function(){return this.debates.map(t=>(t.creator_name=t.creator.name,t.creator_avatar_url=t.creator.avatar_url,t.creator_organization_name=t.organization.name,t))}},methods:{userCheck(t){this.$errorHandler.organizationCheck(this.userOrganizationId)||(this.expanded=!1)},truncate:function(t){const e=8;return t.length>e?t.slice(0,e)+"...":t},setupTable:function(){this.columns=[{name:"title",label:"Title",field:"title",align:"left",classes:"ellipsis"},{name:"description",label:"Description",field:"description",sortable:!0,align:"left",classes:"ellipsis",format:t=>t.length>50?t.slice(0,50)+"...":t},{name:"creator",label:"Created by",field:"creator_name",sortable:!0,align:"left"},{name:"creator_organization",label:"Organization",field:"creator_organization_name",sortable:!0,align:"left"},{name:"create_date",label:"Date",field:"create_date",sortable:!0,align:"left",format:t=>P["b"].formatDate(t,"M/D/YY")}]},onIntersection:function(t,e){this.loadNum>1&&(this.pointer=this.pointer+this.limit,this.loadDebates()),this.loadNum++},onRowClick:function(t,e){this.openDebate(e)},openDebate:function(t){this.childDebateId=t.id,this.showDebate=!0},loadDebates:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/debates?filter[where][conflict_id]=${this.conflictId}&filter[include][0][relation]=organization&filter[include][1][relation]=creator&filter[order]=create_date%20DESC&filter[limit]=${this.limit}&filter[skip]=${this.pointer}`,e=yield this.$axios.get(t);this.limit>e.data.length&&(this.done=!0),this.debates=this.debates.concat(e.data)}));return function(){return t.apply(this,arguments)}}(),reload:function(){this.showDebate=!1,this.expanded=!1,this.debates=[],this.loadDebates()}}},At=Et,St=Object(m["a"])(At,nt,ot,!1,null,null,null),Nt=St.exports,jt={name:"ConflictPanelsSection",components:{TreatyTableComponent:rt,DebateTableComponent:Nt,ConflictEntitySection:Y,ActivityListPage:C["default"]},props:["userOrganizationId","orgA","orgB","conflictId","reload","title"],data(){return{tab:"activity",counter:0,numTreaties:0,numGrievances:0,numOffers:0,numTopics:0,numActivity:0}},mounted(){this.getNums()},methods:{getNums:function(){var t=o()((function*(){let t="",e={},a={};const i=[{key:"treaties",varName:"numTreaties"},{key:"debates",varName:"numTopics"},{key:"grievances",varName:"numGrievances"},{key:"offers",varName:"numOffers"}];for(let r=0;r<i.length;r++)a=i[r],t=`https://concordant-api.herokuapp.com/${a.key}/count?where[conflict_id]=${this.conflictId}`,e=yield this.$axios.get(t),this[a.varName]=e.data.count;t="https://concordant-api.herokuapp.com/activities/count?[where][and][0][entity_type]=conflict&[where][and][1][entity_id]="+this.conflictId,console.log(t),e=yield this.$axios.get(t),console.log(e),this.numActivity=e.data.count}));return function(){return t.apply(this,arguments)}}(),reloadPanel:function(){var t=o()((function*(){yield this.getNums(),this.counter++}));return function(){return t.apply(this,arguments)}}()}},Bt=jt,Rt=Object(m["a"])(Bt,y,q,!1,null,null,null),Lt=Rt.exports,Pt={meta(){return{title:this.name}},components:{ConflictPanelsSection:Lt,ConflictHeaderSection:v},data(){return{id:this.$route.params.id,name:"",status:"",conflict_creator_user_id:null,description:"",avatar_url:"",org_a:{},org_b:{},grievances:{},offers:{},loading:!0,user_organization_id:null,user_organization_name:"n/a",org_obj:{},joinedList:[],verify_org:!1,conflictId:null,counter:0}},created(){var t=this;return o()((function*(){t.reload()}))()},methods:{setOrg:function(t){this.user_organization_name=t.name,this.user_organization_id=t.id,this.reload()},getUserOrg:function(){var t=o()((function*(){if(this.user_organization_id)return!0;const t="https://concordant-api.herokuapp.com/user-to-organizations?filter[where][creator_user_id]="+this.$store.state.user.uid,e=yield this.$axios.get(t);this.joined=e.data,this.joinedList=e.data.filter(t=>t.organization_id===this.org_a.id||t.organization_id===this.org_b.id).map(t=>t.organization_id),this.joinedList.length>1&&(this.verify_org=!0),1===this.joinedList.length&&(this.user_organization_id=this.joinedList[0],this.user_organization_name=this.org_obj[this.user_organization_id],this.$q.notify({type:"info",message:"You are logged in as: "+this.user_organization_name})),0===this.joined.length&&this.$q.notify({type:"error",message:"Please join organization to comment"})}));return function(){return t.apply(this,arguments)}}(),reload:function(){var t=o()((function*(){let t=`https://concordant-api.herokuapp.com/conflicts/${this.$route.params.id}?filter={"order":["create_date DESC"]}`;const e=yield this.$axios.get(t);this.conflictId=e.data.id,this.name=e.data.name,this.status=e.data.status,this.conflict_creator_user_id=e.data.creator_user_id,this.description=e.data.description,this.avatar_url=e.data.avatar_url,t=`https://concordant-api.herokuapp.com/organizations/?filter[where][or][0][id]=${e.data.organization_a_id}&filter[where][or][1][id]=${e.data.organization_b_id}`;const a=yield this.$axios.get(t);this.org_a=a.data[0],this.org_b=a.data[1],this.org_obj[this.org_a.id]=this.org_a.name,this.org_obj[this.org_b.id]=this.org_b.name,this.updateOrgs(e.data),this.getUserOrg(),this.loading=!1}));return function(){return t.apply(this,arguments)}}(),updateOrgs:function(t){if(this.grievances={},this.grievances[this.org_a.name]=[],this.grievances[this.org_b.name]=[],"object"===typeof t.grievances)for(let e=t.grievances.length-1;e>=0;e--)this.grievances[t.grievances[e].organization.name].push(t.grievances[e]);if(this.offers={},this.offers[this.org_a.name]=[],this.offers[this.org_b.name]=[],"object"===typeof t.offers)for(let e=t.offers.length-1;e>=0;e--)this.offers[t.offers[e].organization.name].push(t.offers[e])}}},Ft=Pt,Ut=Object(m["a"])(Ft,i,r,!1,null,null,null);e["default"]=Ut.exports}}]);