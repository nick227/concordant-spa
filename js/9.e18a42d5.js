(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"8a18":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-width"},[i("div",{staticClass:"row q-pl-lg q-pr-lg"},[i("ActivityCreateWidget",{attrs:{reload:t.reload}}),i("q-space"),t.items.length||t.done?t._e():i("h5",{staticClass:"q-ma-lg text-center"},[t._v("LOADING...")]),!t.items.length&&t.done?i("h5",{staticClass:"q-ma-lg text-center"},[t._v("Nothing found.")]):t._e(),t._l(t.items,(function(e){return i("ActivityCardItem",{key:e.id,attrs:{item:e,reload:t.reload}})}))],2),t.done?t._e():i("div",{directives:[{name:"intersection",rawName:"v-intersection",value:t.onIntersection,expression:"onIntersection"}],staticClass:"full-width text-center"},[i("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)])},o=[],s=i("c973"),a=i.n(s),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"full-width q-pa-lg"},[i("q-card",{staticClass:"q-pb-lg"},[i("q-card-section",{staticClass:"q-pb-md text-center"},[i("div",{},[i("router-link",{attrs:{to:"profile/"+t.item.creator.id}},[t._v(t._s(t.item.creator.name))])],1),i("q-avatar",{attrs:{round:"",size:"40px"}},[i("img",{attrs:{src:t.item.creator.avatar_url}})])],1),i("q-card-section",{staticClass:"q-pa-none text-center",attrs:{side:""}},[i("div",{staticClass:"q-pb-lg",domProps:{innerHTML:t._s(t.readyMessage)}}),i("div",{staticClass:"q-pa-sm"},[i("EmotionPickerWidget",{attrs:{emotions:t.item.emotions,activityId:t.item.id}}),t.$errorHandler.isLoggedInUser(t.item.creator_user_id)?i("q-icon",{staticClass:"cursor-pointer float-right q-mt-sm",attrs:{name:"delete",color:"primary",size:"20px",clickable:""},on:{click:t.promptDelete}}):t._e()],1)])],1),i("CommentsWidget",{attrs:{entityId:t.item.id,entityType:"activity"}}),i("q-dialog",{attrs:{persistent:""},model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this?")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteItem}})],1)],1)],1)],1)},l=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("q-chip",{attrs:{disable:t.emotion.important.disabled,selected:t.emotion.important.val,color:"primary",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.important,"val",e)},click:function(e){return t.updateEmotion("important")}}},[t._v("\n      "+t._s(t.emotion.important.num)+" Important\n    ")]),i("q-chip",{attrs:{disable:t.emotion.interesting.disabled,selected:t.emotion.interesting.val,color:"teal",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.interesting,"val",e)},click:function(e){return t.updateEmotion("interesting")}}},[t._v("\n      "+t._s(t.emotion.interesting.num)+" Interesting\n    ")]),i("q-chip",{attrs:{disable:t.emotion.fake.disabled,selected:t.emotion.fake.val,color:"orange",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.fake,"val",e)},click:function(e){return t.updateEmotion("fake")}}},[t._v("\n      "+t._s(t.emotion.fake.num)+" Fake\n    ")]),i("q-chip",{attrs:{disable:t.emotion.terrible.disabled,selected:t.emotion.terrible.val,color:"red",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.terrible,"val",e)},click:function(e){return t.updateEmotion("terrible")}}},[t._v("\n      "+t._s(t.emotion.terrible.num)+" Terrible\n    ")])],1)},m=[],d={name:"EmotionPickerWidget",components:{},props:["emotions","activityId"],data(){return{emotion:{important:{num:0,val:!1,id:null,disabled:!1},interesting:{num:0,val:!1,id:null,disabled:!1},fake:{num:0,val:!1,id:null,disabled:!1},terrible:{num:0,val:!1,id:null,disabled:!1}}}},methods:{updateEmotion:function(t){this.emotion[t].disabled=!0,this.emotion[t].val?this.addEmotion(t):this.removeEmotion(t)},addEmotion:function(){var t=a()((function*(t){const e="http://localhost:3000/activity-emotions",i={name:t,activity_id:this.activityId,creator_user_id:this.$store.state.user.uid};yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}).then(e=>{this.emotion[t].id=e.data.id,this.emotion[t].num++,this.emotion[t].disabled=!1}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving emotion: "+t})})}));return function(e){return t.apply(this,arguments)}}(),removeEmotion:function(){var t=a()((function*(t){const e="http://localhost:3000/activity-emotions/"+this.emotion[t].id;yield this.$axios.delete(e).then(()=>{this.emotion[t].num--,this.emotion[t].disabled=!1}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving emotion: "+t})})}));return function(e){return t.apply(this,arguments)}}()},mounted(){if(this.emotions){const t=this;this.emotions.forEach((function(e){e.creator_user_id===t.$store.state.user.uid&&(t.emotion[e.name].val=!0,t.emotion[e.name].id=e.id),t.emotion[e.name].num=t.emotion[e.name].num+1}))}}},u=d,h=i("2877"),p=Object(h["a"])(u,c,m,!1,null,null,null),v=p.exports,f=i("9088"),g=i("c80c"),y={name:"ActivityCardItem",mixins:[g["a"]],components:{CommentsWidget:f["a"],EmotionPickerWidget:v},props:["item","reload"],data(){return{confirmDelete:!1}},computed:{readyMessage:function(){return this.checkStr(this.item.message)}},methods:{deleteItem:function(){var t=a()((function*(){this.confirmDelete=!1;const t=this,e=["activity-comments","activity-emotions",""];e.forEach((function(i,n){console.log(n+1,e.length,n+1<e.length),t.deleteQuery(i,n+1===e.length)}))}));return function(){return t.apply(this,arguments)}}(),deleteQuery:function(){var t=a()((function*(t,e){const i=`http://localhost:3000/activities/${this.item.id}/${t}`;yield this.$axios.delete(i).then(()=>{e&&(this.reload(),this.$q.notify({type:"positive",message:"Item deleted"}))}).catch(t=>{this.$q.notify({type:"negative",message:"Error deleting: "+t})})}));return function(e,i){return t.apply(this,arguments)}}(),promptDelete:function(){this.confirmDelete=!0}}},b=y,q=Object(h["a"])(b,r,l,!1,null,null,null),_=q.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-pa-lg full-width"},[i("q-form",{on:{submit:t.postActivity}},[i("q-editor",{staticClass:"full-width bg-blue-grey-2",attrs:{flat:"",height:"100px","content-class":"bg-white-5","toolbar-text-color":"black","toolbar-toggle-color":"grey-8",placeholder:"What's up?","toolbar-bg":"grey-4",toolbar:[["bold","italic","underline"],[{label:t.$q.lang.editor.formatting,icon:t.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h3","h4","h5","h6","code"]}]]},model:{value:t.newActivity,callback:function(e){t.newActivity=e},expression:"newActivity"}}),i("div",{staticClass:"row"},[i("q-space"),i("q-btn",{attrs:{type:"submit",color:"primary q-mt-sm full-width"}},[t._v("submit")])],1)],1)],1)},x=[],E={name:"ActivityCreateWidget",props:["reload"],components:{},data(){return{newActivity:""}},methods:{postActivity:function(){var t=a()((function*(){const t="http://localhost:3000/activities",e={creator_user_id:this.$store.state.user.uid,message:this.newActivity};yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}),this.newActivity="",this.reload()}));return function(){return t.apply(this,arguments)}}()}},k=E,C=Object(h["a"])(k,w,x,!1,null,null,null),$=C.exports,I={meta(){return{title:"Activity"}},name:"ActivityListPage",components:{ActivityCreateWidget:$,ActivityCardItem:_},data(){return{items:[],pointer:0,limit:3,done:!1,loadNum:0}},created(){this.getItems()},methods:{onIntersection:function(t,e){this.loadNum>1&&(this.pointer=this.pointer+this.limit,this.getItems()),this.loadNum++},reload:function(){console.log("RELOADDDDIINNG"),this.pointer=0,this.done=!1,this.items=[],this.getItems()},getItems:function(){var t=a()((function*(){const t=`http://localhost:3000/activities?filter[limit]=${this.limit}&filter[skip]=${this.pointer}&filter[include][0][relation]=creator&filter[include][1][relation]=emotions&filter[order]=create_date%20DESC`;console.log(t);const e=yield this.$axios.get(t);this.limit>e.data.length&&(this.done=!0),this.items=this.items.concat(e.data)}));return function(){return t.apply(this,arguments)}}()},mounted(){}},A=I,D=Object(h["a"])(A,n,o,!1,null,null,null);e["default"]=D.exports}}]);