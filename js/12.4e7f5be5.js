(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"0c9c":function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("q-page",{staticClass:"river-width",attrs:{padding:""}},[e("q-expansion-item",{attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Create Organization"},model:{value:t.expanded,callback:function(i){t.expanded=i},expression:"expanded"}},[e("CreateOrganizationWidget",{attrs:{reload:t.reload}})],1),e("h6",{staticClass:"q-mb-sm"},[t._v("Organizations")]),e("q-list",{attrs:{padding:""}},[e("q-separator"),t.organizations.length||t.done?t._e():e("h3",{staticClass:"q-ma-lg text-center"},[t._v("LOADING...")]),!t.organizations.length&&t.done?e("h3",{staticClass:"q-ma-lg text-center"},[t._v("No organizations found.")]):t._e(),t._l(t.organizations,(function(i){return e("div",{key:i.id},[e("q-item",{staticClass:"full-width"},[e("q-card",{staticClass:"full-width"},[e("q-img",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"q-mt-none cursor-pointer",attrs:{rounded:"",clickable:"",src:i.avatar_url},on:{click:function(e){return t.goto("/organization/"+i.id)}}}),e("q-card-section",[e("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"text-h6 cursor-pointer",attrs:{clickable:""},on:{click:function(e){return t.goto("/organization/"+i.id)}}},[t._v(t._s(i.name))])]),e("q-card-section",{staticClass:"q-pt-none"},[t._v("\n      "+t._s(i.description)+"\n    ")]),e("div",{staticClass:"text-right q-pa-lg"},[e("q-btn",{staticStyle:{width:"100px"},attrs:{label:-1===t.joinedList.indexOf(i.id)?"Join":"Unjoin",color:-1===t.joinedList.indexOf(i.id)?"primary":"secondary",ripple:{center:!0}},on:{click:function(e){return t.joinBtn(i.id)}}})],1)],1)],1),e("q-separator")],1)})),t.done?t._e():e("div",{directives:[{name:"intersection",rawName:"v-intersection",value:t.onIntersection,expression:"onIntersection"}],staticClass:"full-width text-center"},[e("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)],2)],1)},a=[],r=e("c973"),o=e.n(r),s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[e("q-input",{attrs:{filled:"",required:"",label:"Name"},model:{value:t.name,callback:function(i){t.name=i},expression:"name"}}),e("q-separator"),e("q-input",{attrs:{filled:"",required:"",label:"Description",autogrow:"",type:"textarea"},model:{value:t.description,callback:function(i){t.description=i},expression:"description"}}),e("q-separator"),e("q-input",{attrs:{filled:"",required:"",label:"Avatar URL"},model:{value:t.avatar_url,callback:function(i){t.avatar_url=i},expression:"avatar_url"}}),e("div",{staticClass:"text-right q-mt-lg"},[e("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}})],1)],1)],1)},l=[],c=(e("e01a"),{name:"CreateOrganizationWidget",props:["reload"],data(){return{name:"",description:"",avatar_url:"",organizations:[]}},methods:{postForm:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/organizations",i={creator_user_id:this.$store.state.user.uid,description:this.description,avatar_url:this.avatar_url,name:this.name};yield this.$axios.post(t,i,{headers:{Accept:"application/json"}}),this.clear(),this.reload()}));return function(){return t.apply(this,arguments)}}(),clear:function(){this.description="",this.name="",this.avatar_url=""}}}),d=c,u=e("2877"),p=Object(u["a"])(d,s,l,!1,null,null,null),h=p.exports,g={meta(){return{title:"Organizations"}},components:{CreateOrganizationWidget:h},name:"OrganizationList",data(){return{joined:[],joinedList:[],organizations:[],expanded:!1,pointer:0,limit:4,done:!1,loadNum:0}},created(){var t=this;return o()((function*(){t.reload()}))()},methods:{goto:function(t){this.$router.push({path:t})},onIntersection:function(t,i){this.loadNum>1&&(this.pointer=this.pointer+this.limit,this.loadOrgs()),this.loadNum++},joinBtn:function(t){this.joinedList.includes(t)?this.unjoin(t):this.join(t)},join:function(){var t=o()((function*(t){if(!this.$errorHandler.loggedInCheck())return!1;const i="https://concordant-api.herokuapp.com/user-to-organizations",e={creator_user_id:this.$store.state.user.uid,organization_id:t};yield this.$axios.post(i,e,{headers:{Accept:"application/json"}}),this.joinedList=[],this.loadJoined()}));return function(i){return t.apply(this,arguments)}}(),unjoin:function(){var t=o()((function*(t){const i=this.joined.filter(i=>i.organization_id===t)[0].id,e="https://concordant-api.herokuapp.com/user-to-organizations/"+i;yield this.$axios.delete(e),this.joinedList=[],this.loadJoined()}));return function(i){return t.apply(this,arguments)}}(),reload:function(){this.expanded=!1,this.joined=[],this.joinedList=[],this.organizations=[],this.loadJoined(),this.loadOrgs()},loadJoined:function(){var t=o()((function*(){if(!this.$store.state.user.uid)return!1;const t="https://concordant-api.herokuapp.com/user-to-organizations?filter[where][creator_user_id]="+this.$store.state.user.uid,i=yield this.$axios.get(t);this.joined=i.data,this.joinedList=i.data.map(t=>t.organization_id)}));return function(){return t.apply(this,arguments)}}(),loadOrgs:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/organizations?filter[order]=create_date%20DESC&filter[limit]=${this.limit}&filter[skip]=${this.pointer}`,i=yield this.$axios.get(t);this.limit>i.data.length&&(this.done=!0),this.organizations=this.organizations.concat(i.data)}));return function(){return t.apply(this,arguments)}}()}},m=g,f=Object(u["a"])(m,n,a,!1,null,null,null);i["default"]=f.exports}}]);