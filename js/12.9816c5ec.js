(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"0c9c":function(t,i,n){"use strict";n.r(i);var e=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("q-page",{staticClass:"river-width",attrs:{padding:""}},[n("q-expansion-item",{attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Create Organization"}},[n("CreateOrganizationWidget")],1),n("h6",{staticClass:"q-mb-sm"},[t._v("Organizations")]),n("q-list",{attrs:{padding:""}},[n("q-separator"),t.organizations.length||t.done?t._e():n("h3",{staticClass:"q-ma-lg text-center"},[t._v("LOADING...")]),!t.organizations.length&&t.done?n("h3",{staticClass:"q-ma-lg text-center"},[t._v("No organizations found.")]):t._e(),t._l(t.organizations,(function(i){return n("div",{key:i.id},[n("q-item",{staticClass:"full-width"},[n("q-card",{staticClass:"full-width"},[n("q-img",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"q-mt-none cursor-pointer",attrs:{rounded:"",clickable:"",src:i.avatar_url},on:{click:function(n){return t.goto("/organization/"+i.id)}}}),n("q-card-section",[n("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"text-h6 cursor-pointer",attrs:{clickable:""},on:{click:function(n){return t.goto("/organization/"+i.id)}}},[t._v(t._s(i.name))])]),n("q-card-section",{staticClass:"q-pt-none"},[t._v("\n      "+t._s(i.description)+"\n    ")]),n("div",{staticClass:"text-right q-pa-lg"},[n("q-btn",{staticStyle:{width:"100px"},attrs:{label:-1===t.joinedList.indexOf(i.id)?"Join":"Unjoin",color:-1===t.joinedList.indexOf(i.id)?"primary":"secondary",ripple:{center:!0}},on:{click:function(n){return t.joinBtn(i.id)}}})],1)],1)],1),n("q-separator")],1)})),t.done?t._e():n("div",{directives:[{name:"intersection",rawName:"v-intersection",value:t.onIntersection,expression:"onIntersection"}],staticClass:"full-width text-center"},[n("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)],2)],1)},a=[],r=n("c973"),o=n.n(r),s=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",[n("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[n("q-input",{attrs:{filled:"",required:"",placeholder:"Name"},model:{value:t.name,callback:function(i){t.name=i},expression:"name"}}),n("q-separator"),n("q-input",{attrs:{filled:"",required:"",placeholder:"Description",autogrow:"",type:"textarea"},model:{value:t.description,callback:function(i){t.description=i},expression:"description"}}),n("q-separator"),n("q-input",{attrs:{filled:"",required:"",placeholder:"Avatar URL"},model:{value:t.avatar_url,callback:function(i){t.avatar_url=i},expression:"avatar_url"}}),n("div",{staticClass:"text-right q-mt-lg"},[n("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}})],1)],1)],1)},c=[],l=(n("e01a"),{name:"CreateOrganizationWidget",data(){return{name:"",description:"",avatar_url:"",organizations:[]}},methods:{postForm:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/organizations",i={creator_user_id:this.$store.state.user.uid,description:this.description,avatar_url:this.avatar_url,name:this.name},n=yield this.$axios.post(t,i,{headers:{Accept:"application/json"}});this.$router.push("/organization/"+n.data.id)}));return function(){return t.apply(this,arguments)}}(),reload:function(){this.description="",this.name="",this.avatar_url=""}}}),d=l,u=n("2877"),p=Object(u["a"])(d,s,c,!1,null,null,null),h=p.exports,g={meta(){return{title:"Organizations"}},components:{CreateOrganizationWidget:h},name:"OrganizationList",data(){return{joined:[],joinedList:[],organizations:[],pointer:0,limit:4,done:!1,loadNum:0}},created(){var t=this;return o()((function*(){t.reload()}))()},methods:{goto:function(t){this.$router.push({path:t})},onIntersection:function(t,i){this.loadNum>1&&(this.pointer=this.pointer+this.limit,this.loadOrgs()),this.loadNum++},joinBtn:function(t){this.joinedList.includes(t)?this.unjoin(t):this.join(t)},join:function(){var t=o()((function*(t){if(!this.$errorHandler.loggedInCheck())return!1;const i="https://concordant-api.herokuapp.com/user-to-organizations",n={creator_user_id:this.$store.state.user.uid,organization_id:t};yield this.$axios.post(i,n,{headers:{Accept:"application/json"}}),this.joinedList=[],this.loadJoined()}));return function(i){return t.apply(this,arguments)}}(),unjoin:function(){var t=o()((function*(t){const i=this.joined.filter(i=>i.organization_id===t)[0].id,n="https://concordant-api.herokuapp.com/user-to-organizations/"+i;yield this.$axios.delete(n),this.joinedList=[],this.loadJoined()}));return function(i){return t.apply(this,arguments)}}(),reload:function(){this.joined=[],this.joinedList=[],this.organizations=[],this.loadJoined(),this.loadOrgs()},loadJoined:function(){var t=o()((function*(){if(!this.$store.state.user.uid)return!1;const t="https://concordant-api.herokuapp.com/user-to-organizations?filter[where][creator_user_id]="+this.$store.state.user.uid,i=yield this.$axios.get(t);this.joined=i.data,this.joinedList=i.data.map(t=>t.organization_id)}));return function(){return t.apply(this,arguments)}}(),loadOrgs:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/organizations?filter[order]=create_date%20DESC&filter[limit]=${this.limit}&filter[skip]=${this.pointer}`,i=yield this.$axios.get(t);this.limit>i.data.length&&(this.done=!0),this.organizations=this.organizations.concat(i.data)}));return function(){return t.apply(this,arguments)}}()}},m=g,f=Object(u["a"])(m,e,a,!1,null,null,null);i["default"]=f.exports}}]);