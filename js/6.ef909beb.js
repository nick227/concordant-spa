(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"713b":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("TopToolbar"),i("q-page-container",[i("router-view")],1),i("q-ajax-bar",{ref:"bar",attrs:{position:"bottom",color:"accent",size:"10px","skip-hijack":""}})],1)},a=[],o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("q-header",{staticClass:"bg-black",attrs:{elevated:"",reveal:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),i("q-toolbar-title",{staticStyle:{overflow:"visible"}},[i("span",{staticClass:"cursor-pointer",on:{click:function(t){return e.$router.push("/")}}},[e._v("CONCORDANT.IO")]),e.profile.id?i("q-avatar",{staticClass:"q-ml-lg"},[i("img",{staticClass:"cursor-pointer",attrs:{src:e.profile.avatar_url},on:{click:function(t){return e.showProfile()}}})]):e._e(),e.newMessages?i("q-btn",{staticClass:"q-pa-none q-ml-md",attrs:{round:"",color:"dark",to:"/messages",icon:"email"}},[i("q-badge",{staticStyle:{"font-size":"0.70em"},attrs:{floating:"",color:"accent"}},[e._v("new "+e._s(e.newMessages))])],1):e._e(),e.profile.id?e._e():i("q-btn",{staticClass:"q-ml-lg",staticStyle:{color:"goldenrod"},attrs:{to:"/login",outline:"",label:"Login"}})],1)],1)],1),i("q-drawer",{attrs:{bordered:"",mini:e.miniState,width:200,"content-class":"bg-black text-white"},on:{mouseover:function(t){e.miniState=!1},mouseout:function(t){e.miniState=!0}},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[i("q-list",{staticClass:"q-pt-lg"},[i("MainNav",{staticClass:"q-mt-lg"})],1)],1)],1)},n=[],r=i("c973"),l=i.n(r),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-list",e._l(e.navItems,(function(t){return i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"},{name:"show",rawName:"v-show",value:t.visible,expression:"item.visible"}],key:t.name,attrs:{clickable:"",tag:t.tagType,to:t.href?t.href:null},on:{mouseover:function(t){e.miniState=!1},mouseout:function(t){e.miniState=!0},click:function(e){t.fn&&t.fn()}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:t.iconName}})],1),i("q-item-section",[i("q-item-label",[e._v(e._s(t.text))])],1)],1)})),1)},u=[],h={name:"MainNav",data(){return{navItems:[{tagType:"a",iconName:"home",href:"/",fn:!1,text:"Home",visible:!0},{tagType:"a",iconName:"flash_on",href:"/conflicts",fn:!1,text:"Conflicts",visible:!0},{tagType:"a",iconName:"article",href:"/treaties",fn:!1,text:"Treaties",visible:!0},{tagType:"a",iconName:"public",href:"/organizations",fn:!1,text:"Organizations",visible:!0},{tagType:"a",iconName:"whatshot",href:"/activity",fn:!1,text:"Activity",visible:!0},{tagType:"a",iconName:"perm_identity",href:"/members",fn:!1,text:"Members",visible:!0},{tagType:"a",iconName:"email",href:"/messages",fn:!1,text:"Messages",visible:!0},{tagType:"a",iconName:"login",href:"/login",fn:!1,text:"Login",visible:!this.$store.state.user.uid},{tagType:"a",iconName:"logout",fn:this.logout,text:"Logout",visible:this.$store.state.user.uid}],active:"Home"}},methods:{logout(){if(this.$store.commit("user/updateUid",null),this.$store.commit("user/updateAvatar",null),this.$store.commit("user/updateName",null),null==this.$hello.getAuthResponse("facebook"))return window.location.href="/",!1;this.$hello("facebook").logout().then((function(){window.location.href="/"}),(function(e){alert("Signed out error: "+e.error.message)}))},isLoggedIntoFb(){this.$hello("facebook").api("me").then(e=>{console.log(e)})}}},f=h,m=i("2877"),p=Object(m["a"])(f,c,u,!1,null,null,null),g=p.exports,d={name:"TopToolbar",mounted(){this.getProfile("facebook"),this.checkMessages()},created(){this.$store.subscribe((e,t)=>{"user/updateMsgCount"===e.type&&this.checkMessages()})},components:{MainNav:g},data(){return{profile:{},leftDrawerOpen:!1,miniState:!0,newMessages:!1}},methods:{showProfile:function(){this.$router.push({path:"/profile/"+this.$store.state.user.uid})},getProfile:function(e){if(!this.$store.state.user.uid)return!1;this.profile.id=this.$store.state.user.uid,this.profile.avatar_url=this.$store.state.user.avatarUrl},checkMessages:function(){var e=l()((function*(){if(this.profile.id){const e=`https://concordant-api.herokuapp.com/user-messages?filter[where][and][0][user_id]=${this.$store.state.user.uid}&filter[where][and][1][status]=0`,t=yield this.$axios.get(e);this.newMessages=t.data.length,this.newMessages&&this.$store.commit("user/updateMsgCount",this.newMessages)}}));return function(){return e.apply(this,arguments)}}()}},b=d,v=Object(m["a"])(b,o,n,!1,null,null,null),w=v.exports,y={name:"MainLayout",components:{TopToolbar:w},data(){return{prevHeight:0}},methods:{beforeLeave(e){this.prevHeight=getComputedStyle(e).height},enter(e){const{height:t}=getComputedStyle(e);e.style.height=this.prevHeight,setTimeout(()=>{e.style.height=t})},afterEnter(e){e.style.height="auto"}}},q=y,k=Object(m["a"])(q,s,a,!1,null,null,null);t["default"]=k.exports}}]);