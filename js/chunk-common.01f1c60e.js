(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{"156d":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bg-grey-6"},[i("h6",{staticClass:"q-pa-sm q-ml-md"},[t._v("New Conflict")]),i("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[i("q-input",{attrs:{filled:"",required:"",placeholder:"Name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),i("q-separator"),i("q-input",{attrs:{filled:"",required:"",placeholder:"Description",autogrow:"",type:"textarea"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),i("q-separator"),i("q-input",{attrs:{filled:"",required:"",placeholder:"Avatar URL",type:"url"},model:{value:t.avatar_url,callback:function(e){t.avatar_url=e},expression:"avatar_url"}}),i("div",{staticClass:"row"},[i("div",{staticClass:"col col-5 float-left"},[i("q-select",{attrs:{filled:"",required:"",value:t.orgA,"use-input":"",readonly:t.optAdisable,"hide-selected":"","fill-input":"","input-debounce":"0",behavior:"menu",options:t.optionsA,placeholder:"Party A"},on:{filter:t.filterFnA,"input-value":t.setModelA},scopedSlots:t._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[t._v("\n            No results\n          ")])],1)]},proxy:!0}])})],1),i("div",{staticClass:"col col-2 text-center q-pt-md"},[t._v("vs.")]),i("div",{staticClass:"col col-5 float-right"},[i("q-select",{attrs:{filled:"",required:"",value:t.orgB,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",behavior:"menu",options:t.optionsB,placeholder:"Party B"},on:{filter:t.filterFnB,"input-value":t.setModelB},scopedSlots:t._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[t._v("\n            No results\n          ")])],1)]},proxy:!0}])})],1)]),i("div",{staticClass:"full-width row"},[i("div",{staticClass:"text-left col-8 col text-red q-mt-sm row"}),i("div",{staticClass:"text-right col col-4 q-mt-lg"},[i("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}})],1)])],1)],1)},s=[],n=(i("e01a"),i("c975"),i("c973")),o=i.n(n),r=i("cf1f"),l={name:"CreateConflictWidget",data(){return{optAdisable:!1,orgA:null,orgB:null,organizationsA:[],organizationsB:[],optionsA:[],optionsB:[],organizationsObj:[],name:"",description:"",avatar_url:""}},props:{defaultOrgName:{type:String,required:!1},reload:{type:Function,required:!1}},mixins:[r["a"]],created(){var t=this;return o()((function*(){yield t.getOrgs(),"string"===typeof t.defaultOrgName?(t.orgA=t.defaultOrgName,t.optAdisable=!0,t.optionsA=[]):t.optionsA=t.organizationsA,t.optionsB=t.organizationsB}))()},methods:{getOrgs:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/organizations?filter[order]=name%20ASC",e=yield this.$axios.get(t);this.organizationsA=this.organizationsB=e.data.map(t=>t.name);for(var i=0,a=e.data.length;i<a;i++)this.organizationsObj[e.data[i].name]=e.data[i].id}));return function(){return t.apply(this,arguments)}}(),filterFnA(t,e,i){e(""!==t?()=>{const e=t.toLocaleLowerCase();this.optionsA=this.organizationsA.filter(t=>t.toLocaleLowerCase().indexOf(e)>-1)}:()=>{this.optionsA=this.organizationsA})},filterFnB(t,e,i){e(""!==t?()=>{const e=t.toLocaleLowerCase();this.optionsB=this.organizationsB.filter(t=>t.toLocaleLowerCase().indexOf(e)>-1)}:()=>{this.optionsB=this.organizationsB})},setModelA(t){this.orgA=t},setModelB(t){this.orgB=t},postForm:function(){var t=o()((function*(){if(!this.$errorHandler.loggedInCheck())return!1;if(this.orgValidate()){const t="https://concordant-api.herokuapp.com/conflicts",e={creator_user_id:this.$store.state.user.uid,name:this.name,description:this.description,organization_a_id:this.organizationsObj[this.orgA],organization_b_id:this.organizationsObj[this.orgB],avatar_url:this.avatar_url},i=yield this.$axios.post(t,e,{headers:{Accept:"application/json"}});this.addAchievement("Added a Conflict"),"function"===typeof this.reload?this.reload(i):this.$router.push("/conflict/"+i.data.id)}}));return function(){return t.apply(this,arguments)}}(),orgValidate:function(){return this.organizationsA.includes(this.orgA)?!!this.organizationsB.includes(this.orgB)||(this.$q.notify({type:"negative",message:"Invalid Party B"}),!1):(this.$q.notify({type:"negative",message:"Invalid Party A"}),!1)}}},c=l,d=i("2877"),u=Object(d["a"])(c,a,s,!1,null,null,null);e["a"]=u.exports},"295b":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.loading?t._e():i("q-page-container",{class:t.treatyId?"full-width":"river-width",style:t.treatyId?"":"padding-top:0"},[i("q-page",{attrs:{padding:""}},[i("div",{staticClass:"row full-width q-pa-sm bg-grey-2"},[i("div",{staticClass:"col col-md-5"},[i("a",{staticClass:"cursor-pointer",on:{click:function(e){return t.$router.push("/organization/"+t.org_a.id)}}},[i("q-avatar",{attrs:{size:"40px",square:""}},[i("q-img",{staticClass:"q-mt-none",attrs:{rounded:"",src:t.org_a.avatar_url}})],1),i("br"),t._v("\n        "+t._s(t.org_a.name)+"\n    ")],1)]),i("div",{staticClass:"col col-md-2 text-center q-pt-md"},[t._v("\n    vs.\n  ")]),i("div",{staticClass:"col col-md-5 text-right"},[i("a",{staticClass:"cursor-pointer",on:{click:function(e){return t.$router.push("/organization/"+t.org_b.id)}}},[i("q-avatar",{attrs:{size:"40px",square:""}},[i("q-img",{staticClass:"q-mt-none",attrs:{rounded:"",src:t.org_b.avatar_url}})],1),i("br"),t._v("\n        "+t._s(t.org_b.name)+"\n    ")],1)])]),t.isUser?i("div",{staticClass:"row relative-position q-mb-sm full-width",staticStyle:{height:"35px"}},[i("q-expansion-item",{staticStyle:{"z-index":"2"},attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Edit Treaty"},model:{value:t.editExpanded,callback:function(e){t.editExpanded=e},expression:"editExpanded"}},[i("EditTreatyWidget",{key:"edit"+t.counter,attrs:{name:t.treaty.name,description:t.treaty.description,avatarUrl:t.treaty.avatar_url,provisions:t.provisions,reload:t.getTreaty,treatyId:t.treaty.id}})],1)],1):t._e(),i("RatingWidget",{attrs:{readonly:!t.userOrganizationId,entityId:t.treaty.id,userOrganizationId:t.userOrganizationId,entityType:"treaty"}}),i("div",{staticClass:"row"},[i("div",{staticClass:"col col-3"},[i("q-img",{attrs:{src:t.treaty.avatar_url}})],1),i("div",{staticClass:"col q-pl-md"},[i("div",{},[i("router-link",{attrs:{to:"/conflict/"+t.treaty.conflict.id}},[t._v(t._s(t.org_a.name)+" vs. "+t._s(t.org_b.name))])],1),i("h4",{staticClass:"q-pa-none"},[t._v(t._s(t.treaty.name))]),i("p",{staticClass:"q-pt-none"},[t._v(t._s(t.treaty.description))]),t.treaty.creator?i("p",{staticClass:"caption q-pt-none"},[t._v("Created by: "),i("router-link",{attrs:{to:"/profile/"+t.treaty.creator.id}},[t._v(t._s(t.treaty.creator.name))])],1):t._e()])]),i("div",{staticClass:"q-mt-sm"},[i("q-expansion-item",{staticClass:"bg-blue-grey-1",attrs:{icon:"share","dense-toggle":"",label:"Share Treaty"},model:{value:t.showShareWidget,callback:function(e){t.showShareWidget=e},expression:"showShareWidget"}},[i("ShareWidget",{attrs:{entityType:"treaty",entityId:t.treaty.id,title:t.treaty.name}})],1)],1),i("q-separator",{staticClass:"q-mt-md"}),t.userOrganizationId?i("CommentsWidget",{attrs:{entityId:t.treaty.id,entityType:"treaty"}}):t._e(),i("q-separator",{staticClass:"q-mt-md"}),t.provisions.length?i("h5",[t._v("Provisions:")]):t._e(),i("q-separator",{staticClass:"q-mb-md"}),t.isUser?i("q-expansion-item",{staticClass:"full-width q-mb-sm bg-blue-grey-1",attrs:{label:"Add Provision"},model:{value:t.expanded,callback:function(e){t.expanded=e},expression:"expanded"}},[i("AddProvision",{attrs:{id:t.treaty.id,numProvisions:t.numProvisions,reload:t.loadProvisions}})],1):t._e(),i("q-list",{staticClass:"full-width"},t._l(t.provisions,(function(e,a){return i("div",{key:e.id,staticClass:"full-width q-mb-sm"},[i("TreatyProvisionComponent",{attrs:{provision:e,index:a,userOrganizationId:t.userOrganizationId,creatorId:t.treaty.creator.id}})],1)})),0),t.userOrganizationId?i("TreatyVoteWidget",{key:"votesw"+t.counter,staticClass:"q-mt-lg q-mb-sm",attrs:{reload:t.getVotes,votes:t.votes,id:t.treaty.id,orgAname:t.org_a.name,orgBname:t.org_b.name,userOrganizationId:t.userOrganizationId}}):t._e(),i("q-separator",{staticClass:"q-mt-md"}),i("h5",[t._v("Votes:")]),i("q-separator",{staticClass:"q-mb-md"}),i("TreatyVotesTable",{key:"votest"+t.counter,attrs:{reload:t.getVotes,votes:t.votes,id:t.treaty.id}}),i("q-dialog",{attrs:{persistent:""},model:{value:t.verify_org,callback:function(e){t.verify_org=e},expression:"verify_org"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"done_outline",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Choose ONE organization to comment as.")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_a.name,color:"primary"},on:{click:function(e){return t.setOrg(t.org_a)}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_b.name,color:"primary"},on:{click:function(e){return t.setOrg(t.org_b)}}})],1)],1)],1),i("RelatedTreatiesWidget",{attrs:{conflictId:t.treaty.conflict.id,currentId:t.treaty.id}})],1)],1)},s=[],n=i("c973"),o=i.n(n),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"text-right"},[i("div",{staticClass:"caption"},[t._v(t._s(t.numRatings)+" ratings")]),i("q-rating",{attrs:{size:"2em",max:5,color:"primary",readonly:t.readonly},on:{click:t.postForm},scopedSlots:t._u([{key:"tip-1",fn:function(){return[i("q-tooltip",[t._v("Worst")])]},proxy:!0},{key:"tip-2",fn:function(){return[i("q-tooltip",[t._v("Okay")])]},proxy:!0},{key:"tip-3",fn:function(){return[i("q-tooltip",[t._v("Good")])]},proxy:!0},{key:"tip-4",fn:function(){return[i("q-tooltip",[t._v("Great")])]},proxy:!0},{key:"tip-5",fn:function(){return[i("q-tooltip",[t._v("Best")])]},proxy:!0}]),model:{value:t.ratingVal,callback:function(e){t.ratingVal=e},expression:"ratingVal"}})],1)},l=[],c={name:"RatingWidget",props:["entityId","userOrganizationId","entityType","readonly"],data(){return{ratingVal:0,numRatings:0,ratings:[]}},mounted(){this.getRating()},methods:{getRating:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}-ratings/?filter[where][${this.entityType}_id]=${this.entityId}&filter[fields][value]=true`,e=yield this.$axios.get(t);this.ratings=e.data,this.numRatings=this.ratings.length,this.ratingVal=Math.round(this.ratings.reduce((t,e)=>t+e.value,0)/this.ratings.length)}));return function(){return t.apply(this,arguments)}}(),postForm:function(){var t=o()((function*(t){if(!this.$errorHandler.organizationCheck(this.userOrganizationId))return!1;const e=`https://concordant-api.herokuapp.com/${this.entityType}-ratings`,i={creator_user_id:this.$store.state.user.uid,organization_id:parseInt(this.userOrganizationId),value:this.ratingVal};i[this.entityType+"_id"]=parseInt(this.entityId),yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}).then(t=>{this.getRating(),this.$q.notify({type:"positive",message:"Rating added"})}).catch(t=>{this.$q.notify({type:"negative",message:t})})}));return function(e){return t.apply(this,arguments)}}()}},d=c,u=i("2877"),p=Object(u["a"])(d,r,l,!1,null,null,null),m=p.exports,h=i("9088"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-pa-md bg-grey-2"},[i("div",{staticClass:"q-mb-md row cursor-pointer",attrs:{clickable:""},on:{click:function(e){return t.share("fb")}}},[i("q-icon",{staticClass:"q-mr-md q-mb-sm",attrs:{name:"ion-logo-facebook",size:"2em"}}),t._v("Share to Facebook")],1),i("div",{staticClass:"q-mb-md row cursor-pointer",attrs:{clickable:""},on:{click:function(e){return t.share("tw")}}},[i("q-icon",{staticClass:"q-mr-md",attrs:{name:"ion-logo-twitter",size:"2em"}}),t._v("Share to Twitter")],1),i("div",{staticClass:"q-mb-md row cursor-pointer",attrs:{clickable:""},on:{click:function(e){return t.share("rd")}}},[i("q-icon",{staticClass:"q-mr-md",attrs:{name:"ion-logo-reddit",size:"2em"}}),t._v("Share to Reddit")],1)])},g=[],v={props:["entityId","entityType","title"],name:"ShareWidget",components:{},data(){return{}},methods:{share:function(t){const e=this.title,i={fb:function(){const t="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(window.location.href);window.open(t,"_blank","height=400,width=480")},tw:function(){const t="https://twitter.com/intent/tweet?text="+encodeURIComponent(e+" "+window.location.href);window.open(t,"_blank","height=400,width=480")},rd:function(){const t="http://www.reddit.com/submit?url="+encodeURIComponent(window.location.href)+"&title="+encodeURIComponent(e);window.open(t,"_blank","height="+.7*screen.availHeight+",width="+.9*screen.width)}};i[t]()}},mounted(){}},y=v,_=Object(u["a"])(y,f,g,!1,null,null,null),b=_.exports,q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dialog-width"},[i("q-form",{staticClass:"q-pa-md bg-grey-4",attrs:{greedy:""},on:{submit:t.postForm}},[i("q-input",{attrs:{filled:"","stack-label":"",label:"Name"},on:{input:t.handleInput},model:{value:t.data_name,callback:function(e){t.data_name=e},expression:"data_name"}}),i("q-separator"),i("q-input",{attrs:{filled:"","stack-label":"",label:"description",name:"description",type:"textarea",autogrow:""},on:{input:t.handleInput},model:{value:t.data_description,callback:function(e){t.data_description=e},expression:"data_description"}}),i("q-separator"),i("q-input",{attrs:{filled:"","stack-label":"",name:"avatarUrl",label:"Avatar URL",type:"url"},on:{input:t.handleInput},model:{value:t.data_avatar_url,callback:function(e){t.data_avatar_url=e},expression:"data_avatar_url"}}),i("div",[i("p",{staticClass:"text-grey-8 q-ml-sm q-pb-none"},[t._v("Delete Provisions:")]),t._l(t.provisions,(function(e){return i("q-chip",{key:e.id,attrs:{removable:"",color:"grey",dense:"","text-color":"black",label:e.title},on:{remove:function(i){return t.deleteProvision(e)}},model:{value:t.data_provisions[e.id],callback:function(i){t.$set(t.data_provisions,e.id,i)},expression:"data_provisions[provision.id]"}})}))],2),i("div",{staticClass:"full-width  text-right q-mt-md"},[i("q-btn",{staticClass:"q-mr-md",attrs:{label:"Delete Treaty",color:"red"},on:{click:function(e){t.confirmDelete=!0}}}),i("q-btn",{attrs:{label:"SUBMIT",type:"submit",color:"primary"}})],1)],1),i("q-dialog",{staticClass:"z-top z-max",staticStyle:{"z-index":"1000"},model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this treaty?")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteTreaty}})],1)],1)],1)],1)},C=[],x=(i("e01a"),{name:"EditTreatyWidget",props:["name","description","avatarUrl","treatyId","reload","provisions"],model:{prop:"name",event:"blur"},watch:{name(t){this.data_name=t},description(t){this.data_description=t},avatarUrl(t){this.data_avatar_url=t}},data(){return{confirmDelete:!1,provisionsToDelete:[],data_provisions:[],data_name:this.name,data_description:this.description,data_avatar_url:this.avatarUrl}},mounted(){this.data_name=this.name,this.$mount()},methods:{deleteTreaty:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/treaties/"+this.treatyId;yield this.$axios.delete(t).then(t=>{this.$router.push("/treaties"),this.$q.notify({type:"positive",message:"Delete Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error (DELETE UNDER DEVELOPMENT): "+t})})}));return function(){return t.apply(this,arguments)}}(),deleteProvision(t){this.provisionsToDelete.push(t.id)},handleInput(t){this.$emit("msgChange",t)},deleteProvisions:function(){var t=o()((function*(){let t=null;for(let e=0;e<this.provisionsToDelete.length;e++)t=`https://concordant-api.herokuapp.com/treaty-provisions/${this.provisionsToDelete[0]}/provision-likes`,yield this.$axios.delete(t),t=`https://concordant-api.herokuapp.com/treaty-provisions/${this.provisionsToDelete[0]}/provision-comments`,yield this.$axios.delete(t),t="https://concordant-api.herokuapp.com/treaty-provisions/"+this.provisionsToDelete[0],console.log(t),yield this.$axios.delete(t);this.reload()}));return function(){return t.apply(this,arguments)}}(),postForm:function(){var t=o()((function*(t){this.deleteProvisions();const e={name:this.data_name,description:this.data_description,avatar_url:this.data_avatar_url,id:this.treatyId},i="https://concordant-api.herokuapp.com/treaties/"+this.treatyId;yield this.$axios.patch(i,e,{headers:{Accept:"application/json"}}).then(t=>{this.reload(),this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error updating Treaty: "+t})})}));return function(e){return t.apply(this,arguments)}}()}}),k=x,w=Object(u["a"])(k,q,C,!1,null,null,null),$=w.exports,I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.links.length?i("div",{staticClass:"text-left river-width q-mt-lg"},[i("q-separator",{staticClass:"q-mt-md"}),i("h5",[t._v("Related treaties:")]),i("q-separator",{staticClass:"q-mb-md"}),t._l(t.links,(function(e){return i("div",{key:e.id,staticClass:"row justify-between full-width"},[i("div",{staticClass:"col col-9"},[i("router-link",{attrs:{to:e.url,replace:""}},[t._v(t._s(e.text))])],1),i("div",{staticClass:"col text-right"},[t._v("Yay: "+t._s(e.yay)+" Nay: "+t._s(e.nay))])])}))],2):t._e()},z=[],T={name:"RelatedTreatiesWidget",props:["conflictId","currentId"],data(){return{treaties:[],limit:5}},computed:{links:function(){return this.treaties.map(t=>("object"!==typeof t.votes&&(t.votes=[]),{url:"/treaty/"+t.id,text:t.name,id:t.id,yay:t.votes.filter(t=>1===t.vote_type).length,nay:t.votes.filter(t=>0===t.vote_type).length}))}},methods:{goto:function(t){window.location.href=t},getUrls:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/treaties?filter[where][and][0][conflict_id]=${this.conflictId}&filter[where][and][1][id][neq]=${this.currentId}&filter[fields][id]=true&filter[fields][name]=true&filter[limit]=${this.limit}&filter[include][0][relation]=votes`,e=yield this.$axios.get(t);this.treaties=e.data,console.log(this.treaties)}));return function(){return t.apply(this,arguments)}}()},created(){this.getUrls()},beforeRouteUpdate(t,e,i){console.log(t),i()}},O=T,A=Object(u["a"])(O,I,z,!1,null,null,null),E=A.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row full-width"},[i("div",{staticClass:"col"}),i("q-form",{staticClass:"col col-8"},[i("q-input",{staticClass:"full-width",attrs:{label:"Title","lazy-rules":"",required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),i("q-input",{staticClass:"full-width",attrs:{label:"Description","lazy-rules":"",autogrow:"",required:"",type:"textarea"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),i("q-btn",{staticClass:"q-ma-md float-right",attrs:{label:"SUBMIT",color:"primary"},on:{click:t.postForm}})],1),i("div",{staticClass:"col"})],1)},S=[],D={name:"AddProvision",props:["treatyId","numProvisions","reload"],data(){return{title:"",description:""}},methods:{postForm:function(){var t=o()((function*(t){const e="https://concordant-api.herokuapp.com/treaty-provisions",i={creator_user_id:this.$store.state.user.uid,treaty_id:this.treatyId,status_id:1,title:this.title,description:this.description,position:this.numProvisions||0};console.log(e),console.log(i),yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}).then(()=>{this.$q.notify({type:"positive",message:"Provision Created"}),this.reload(),this.title="",this.description="",window.scrollTo(2,document.body.scrollHeight)}).catch(t=>{this.$q.notify({type:"negative",message:"Error creating provision: "+t})})}));return function(e){return t.apply(this,arguments)}}()}},N=D,P=Object(u["a"])(N,j,S,!1,null,null,null),L=P.exports,U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",{staticClass:"col bg-blue-grey-1 col-12 q-pl-lg q-pr-lg q-pt-sm q-pb-sm row flex-center"},[i("h6",{staticClass:"q-ma-lg"},[t._v("Do you agree to this treaty?")]),i("div",{staticClass:"row flex-center text-center",staticStyle:{"flex-wrap":"nowrap","white-space":"nowrap"}},[i("q-btn",{staticClass:"q-mr-sm",attrs:{padding:"lg",color:"positive",round:"",disabled:t.voted,label:"AYE"},on:{click:function(e){return t.confirm(1)}}}),i("q-btn",{staticClass:"q-ma-md",attrs:{padding:"lg",color:"negative",round:"",disabled:t.voted,label:"NAY"},on:{click:function(e){return t.confirm(0)}}})],1)]),i("q-separator"),i("div",{staticClass:"row text-center justify-center full-width"},[i("div",{staticClass:"text-right col q-pr-lg"},[t._v("total:")]),i("div",{staticClass:"text-green q-mr-md"},[t._v(t._s(t.num_yay)+" Yay")]),i("div",[t._v("/")]),i("div",{staticClass:"text-red q-ml-md"},[t._v(t._s(t.num_nay)+" Nay")])]),i("div",{staticClass:"row text-center justify-center full-width"},[i("div",{staticClass:"text-right col q-pr-lg"},[t._v(t._s(t.orgAname)+":")]),i("div",{staticClass:"text-green q-mr-md"},[t._v(t._s(t.org_a_votes.yay)+" Yay")]),i("div",[t._v("/")]),i("div",{staticClass:"text-red q-ml-md"},[t._v(t._s(t.org_a_votes.nay)+" Nay")])]),i("div",{staticClass:"row text-center justify-center full-width"},[i("div",{staticClass:"text-right col q-pr-lg"},[t._v(t._s(t.orgBname)+":")]),i("div",{staticClass:"text-green q-mr-md"},[t._v(t._s(t.org_b_votes.yay)+" Yay")]),i("div",[t._v("/")]),i("div",{staticClass:"text-red q-ml-md"},[t._v(t._s(t.org_b_votes.nay)+" Nay")])]),i("q-dialog",{attrs:{persistent:""},model:{value:t.verify,callback:function(e){t.verify=e},expression:"verify"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"done_outline",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Are you sure?")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Vote "+t.voteTxt,color:"primary"},on:{click:t.vote}})],1)],1)],1)],1)},W=[],B={name:"TreatyVoteWidget",props:["id","userOrganizationId","votes","reload","orgAname","orgBname"],data(){return{count:0,voteVal:null,voted:!1,verify:!1,voteTxt:null}},computed:{org_a_votes:function(){return{yay:this.votes.filter(t=>1===t.vote&&t.organization===this.orgAname).length,nay:this.votes.filter(t=>0===t.vote&&t.organization===this.orgAname).length}},org_b_votes:function(){return{yay:this.votes.filter(t=>1===t.vote&&t.organization===this.orgBname).length,nay:this.votes.filter(t=>0===t.vote&&t.organization===this.orgBname).length}},num_yay:function(){return this.votes.filter(t=>1===t.vote).length},num_nay:function(){return this.votes.filter(t=>0===t.vote).length}},methods:{confirm:function(){var t=o()((function*(t){this.voteVal=t,this.voteTxt=t?"Yay":"Nay",this.verify=!0}));return function(e){return t.apply(this,arguments)}}(),vote:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/votes",e={creator_user_id:this.$store.state.user.uid,treaty_id:parseInt(this.id),organization_id:parseInt(this.userOrganizationId),vote_type:this.voteVal};yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}).then(()=>{this.reload(),this.voted=!0,this.$q.notify({type:"positive",message:"Vote Received"})}).catch(t=>{this.$q.notify({type:"negative",message:"Voting error: "+t})})}));return function(){return t.apply(this,arguments)}}()}},R=B,V=Object(u["a"])(R,U,W,!1,null,null,null),M=V.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row full-width"},[i("q-table",{staticClass:"full-width align-left table q-pa-sm",attrs:{title:"",dense:"",flat:"",data:t.votes,filter:t.filter,columns:t.columns,"row-key":"id",pagination:t.initialPagination,columns_filter:!0},scopedSlots:t._u([{key:"top-right",fn:function(){return[i("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[i("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0}])})],1)},Y=[],H=i("b178"),Z={name:"TreatyVotesTable",props:["votes","id"],data(){return{filter:"",columns:[],initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:50}}},methods:{setupTable:function(){this.columns=[{name:"vote",label:"Vote",field:"vote",format:t=>t?"Yay":"Nay",sortable:!0,align:"left",class:"q-pa-sm"},{name:"name",label:"Name",field:"name",align:"left",sortable:!0,class:"q-pa-sm"},{name:"location",label:"Location",field:"location",sortable:!0,align:"left",class:"q-pa-sm"},{name:"organization",label:"Organization",field:"organization",sortable:!0,align:"left",class:"q-pa-sm",filter_type:"select"},{name:"date",label:"Date",field:"date",sortable:!0,align:"left",format:t=>H["b"].formatDate(t,"M/D/YY"),class:"q-pa-sm"}]}},created(){this.setupTable()}},G=Z,J=Object(u["a"])(G,F,Y,!1,null,null,null),Q=J.exports,K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"row q-mb-sm"},[i("div",{staticClass:"col col-1 text-center"},[i("h4",{staticClass:"border text-center q-pa-sm bg-blue-grey-1"},[t._v(t._s(t.index+1))])]),i("div",{staticClass:"col text-left q-pl-md"},[i("h6",{staticClass:"q-pa-none"},[t._v(t._s(t.title)+"\n        "),t.isUser?i("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer",attrs:{name:"edit",clickable:"",size:"13px"}}):t._e(),i("q-popup-edit",{attrs:{buttons:"",validate:t.edit},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[i("q-input",{attrs:{validate:t.edit,"auto-save":"","label-set":"Save",dense:"",autofocus:"",counter:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1),i("p",{staticClass:"q-pa-none"},[t._v(t._s(t.description)+" "),t.isUser?i("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer",attrs:{name:"edit",clickable:"",size:"13px"}}):t._e(),i("q-popup-edit",{attrs:{buttons:"",validate:t.edit},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}},[i("q-input",{attrs:{"auto-save":"","label-set":"Save",dense:"",autofocus:"",counter:""},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1)]),i("div",{staticClass:"col col-1 q-pt-sm"},[i("LikeButtons",{staticClass:"float-right",attrs:{entityType:"provision",entityId:t.provision.id,organizationId:t.userOrganizationId}})],1)]),i("CommentsWidget",{attrs:{entityId:t.provision.id,entityType:"provision",userOrganizationId:t.userOrganizationId}})],1)},X=[],tt=i("3cc5"),et={name:"TreatyProvisionComponent",props:["provision","index","userOrganizationId","creatorId"],components:{LikeButtons:tt["a"],CommentsWidget:h["a"]},data(){return{title:this.provision.title,description:this.provision.description,id:this.provision.id,isUser:this.$errorHandler.isLoggedInUser(this.creatorId)}},methods:{edit:function(){var t=o()((function*(t){const e="https://concordant-api.herokuapp.com/treaty-provisions/"+this.id,i={title:this.title,description:this.description};yield this.$axios.patch(e,i).then(t=>{this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error Saving: "+t})})}));return function(e){return t.apply(this,arguments)}}()},mounted(){}},it=et,at=Object(u["a"])(it,K,X,!1,null,null,null),st=at.exports,nt={name:"TreatyPage",meta(){return{title:this.treaty.name,image:this.treaty.avatar_url}},props:["treatyId"],components:{AddProvision:L,CommentsWidget:h["a"],TreatyVoteWidget:M,RatingWidget:m,TreatyVotesTable:Q,EditTreatyWidget:$,TreatyProvisionComponent:st,RelatedTreatiesWidget:E,ShareWidget:b},data(){return{showShareWidget:!1,userOrganizationId:null,creatorName:null,creatorId:null,counter:0,editExpanded:!1,expanded:!1,provisions:[],columns:[],numProvisions:0,isUser:!1,votes:[],treaty:{},loading:!0,verify_org:!1,org_a:{},org_b:{},treaty_id:this.treatyId||this.$route.params.id,initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:10}}},methods:{getTreaty:function(){var t=o()((function*(){this.editExpanded=this.expanded=!1;const t=`https://concordant-api.herokuapp.com/treaties/${this.treaty_id}?filter={"include":[{"relation":"creator"},{"relation":"conflict", "scope":{"include":[{"relation":"organization_a"},{"relation":"organization_b"}]}}]}`,e=yield this.$axios.get(t);this.treaty=e.data,this.org_a=this.treaty.conflict.organization_a,this.org_b=this.treaty.conflict.organization_b,this.getUserOrg(),this.getVotes(),this.loadProvisions(),this.setupTable(),this.isUser=this.$errorHandler.isLoggedInUser(this.treaty.creator_user_id),this.loading=!1}));return function(){return t.apply(this,arguments)}}(),setOrg:function(t){this.userOrganizationName=t.name,this.userOrganizationId=t.id,this.reload()},getUserOrg:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/user-to-organizations?filter[where][and][0][creator_user_id]=${this.$store.state.user.uid}&filter[where][or][1][organization_id]=${this.org_a.id}&filter[where][or][2][organization_id]=${this.org_b.id}`,e=yield this.$axios.get(t);this.joined=e.data,this.joined.length>1&&(this.verify_org=!0),1===this.joined.length&&(this.userOrganizationId=this.joined[0].organization_id,this.userOrganizationName=this.joined[0].name),0===this.joined.length&&this.$q.notify({type:"info",message:"Please join organization to comment"})}));return function(){return t.apply(this,arguments)}}(),setupTable:function(){this.columns=[{name:"position",align:"left",label:"Position",field:"position",sortable:!0,style:"width:55px;"},{name:"title",align:"left",label:"Title",field:"title",sortable:!0},{name:"description",align:"left",label:"Description",field:"description",sortable:!0}]},getVotes:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/votes?filter[where][treaty_id]=${this.treaty_id}&filter[include][0][relation]=creator&filter[include][1][relation]=organization&filter[order]=create_date%20DESC`,e=yield this.$axios.get(t);if(console.log(e),!e.data.length)return!1;this.votes=e.data.map(t=>({creatorUserId:t.creator_user_id,date:t.create_date,name:t.creator.name,location:t.creator.location,organization:t.organization.name,vote:t.vote_type,sortable:!0})),this.counter=this.counter+1}));return function(){return t.apply(this,arguments)}}(),loadProvisions:function(){var t=o()((function*(){this.editExpanded=this.expanded=!1;const t=`https://concordant-api.herokuapp.com/treaty-provisions?filter[where][treaty_id]=${this.treaty_id}&filter[order]=position%20ASC`,e=yield this.$axios.get(t);this.provisions=e.data,this.numProvisions=this.provisions.length?this.provisions.length:0}));return function(){return t.apply(this,arguments)}}()},created(){this.getTreaty()}},ot=nt,rt=Object(u["a"])(ot,a,s,!1,null,null,null);e["default"]=rt.exports},"3cc5":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row",staticStyle:{width:"60px"}},[i("div",{staticClass:"col col-6 text-center"},[i("div",[i("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],class:t.readonly?"":"cursor-pointer",attrs:{name:"thumb_up",color:"blue"},on:{click:t.like}})],1),i("div",[i("span",{staticClass:"text-weight-bolder"},[t._v(t._s(t.numLikes))])])]),i("div",{staticClass:"col col-6 text-center"},[i("div",{attrs:{ripple:""}},[i("q-icon",{directives:[{name:"ripple",rawName:"v-ripple"}],class:t.readonly?"":"cursor-pointer",attrs:{name:"thumb_down",color:"red"},on:{click:t.dislike}})],1),i("div",[i("span",{staticClass:"text-weight-bolder"},[t._v(t._s(t.numDislikes))])])])])},s=[],n=i("c973"),o=i.n(n),r={name:"LikeButtons",props:["entityType","entityId","organizationId","organizationName","readonly"],data(){return{numLikes:0,numDislikes:0,org_a:{},org_b:{}}},methods:{like:function(){var t=o()((function*(){this.update(1)}));return function(){return t.apply(this,arguments)}}(),dislike:function(){this.update(0)},update:function(){var t=o()((function*(t){if(!this.$errorHandler.loggedInCheck())return!1;if(!this.$errorHandler.organizationCheck(this.organizationId))return!1;if(this.readonly)return this.$q.notify({type:"negative",message:"Wrong Organization"}),!1;const e=`https://concordant-api.herokuapp.com/${this.entityType}-likes`,i={creator_user_id:this.$store.state.user.uid,organization_id:this.organizationId,liked:t};i[this.entityType+"_id"]=this.entityId,console.log(e),console.log(i),yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}),this.getLikes()}));return function(e){return t.apply(this,arguments)}}(),getLikes:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}-likes?filter[where][and][0][${this.entityType}_id]=${this.entityId}&filter[where][and][1][organization_id]=${this.organizationId}`,e=yield this.$axios.get(t);this.numLikes=0,this.numDislikes=0;for(let i=0;i<e.data.length;i++)1===e.data[i].liked&&(this.numLikes=this.numLikes+1),0===e.data[i].liked&&(this.numDislikes=this.numDislikes+1)}));return function(){return t.apply(this,arguments)}}()},mounted(){this.getLikes()}},l=r,c=i("2877"),d=Object(c["a"])(l,a,s,!1,null,null,null);e["a"]=d.exports},4729:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},s=[],n=i("b178"),o={name:"TextToolsMixin",methods:{timeSince:function(t){const e=Math.max(n["b"].getDateDiff(new Date,t,"seconds"),0);return e<60?e+" seconds ago":e<3600?n["b"].getDateDiff(new Date,t,"minutes")+" minutes ago":e<43200?n["b"].getDateDiff(new Date,t,"hours")+" hours ago":n["b"].getDateDiff(new Date,t,"days")+" days ago"}}},r=o,l=i("2877"),c=Object(l["a"])(r,a,s,!1,null,null,null);e["a"]=c.exports},"8a18":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.entityId?"full-width":"river-width"},[i("div",{staticClass:"q-mt-lg"},[t.entityId?t._e():i("h6",{staticClass:"q-mb-sm text-center"},[t._v("Activity")]),t.entityId?t._e():i("q-separator",{staticClass:"q-mb-lg"}),i("div",{staticClass:"row"},[i("ActivityCreateWidget",{staticClass:"q-pb-lg q-mb-lg",attrs:{reload:t.reload,entityType:t.entityType,entityId:t.entityId}}),i("q-space"),i("q-space"),t.items.length||t.done?t._e():i("h5",{staticClass:"q-ma-lg text-center"},[t._v("LOADING...")]),!t.items.length&&t.done?i("h5",{staticClass:"q-ma-lg text-center"},[t._v("Nothing found.")]):t._e(),t._l(t.items,(function(e){return i("ActivityCardItem",{key:e.id,attrs:{entityId:t.entityId,entityType:t.entityType,item:e,reload:t.reload}})}))],2),t.done?t._e():i("div",{directives:[{name:"intersection",rawName:"v-intersection",value:t.onIntersection,expression:"onIntersection"}],staticClass:"full-width text-center"},[i("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)],1)])},s=[],n=i("c973"),o=i.n(n),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"full-width q-mb-lg"},[i("q-card",{staticClass:"q-pb-lg"},[i("div",{staticClass:"bg-grey full-width",staticStyle:{height:"10px"}}),i("q-card-section",{staticClass:"q-pb-md text-center"},[i("div",{},[i("router-link",{attrs:{to:"profile/"+t.item.creator.id}},[t._v(t._s(t.item.creator.name))])],1),i("q-avatar",{attrs:{round:"",size:"40px"}},[i("img",{attrs:{src:t.item.creator.avatar_url}})])],1),i("q-card-section",{staticClass:"q-pa-none text-center",attrs:{side:""}},[i("div",{staticClass:"q-pb-sm",domProps:{innerHTML:t._s(t.readyMessage)}}),i("div",{staticClass:"text-center full-width"},[t._v(t._s(t.readyDate))]),"number"===typeof t.item.entity_id?i("div",{staticClass:"text-center full-width"},[i("router-link",{attrs:{to:"/"+t.item.entity_type+"/"+t.item.entity_id}},[t._v("original post")])],1):t._e(),i("div",{staticClass:"q-pa-sm"},[i("EmotionPickerWidget",{attrs:{emotions:t.item.emotions,activityId:t.item.id}}),t.$errorHandler.isLoggedInUser(t.item.creator_user_id)?i("q-icon",{staticClass:"cursor-pointer float-right q-mt-sm",attrs:{name:"delete",color:"primary",size:"20px",clickable:""},on:{click:t.promptDelete}}):t._e()],1)])],1),i("CommentsWidget",{attrs:{entityId:t.item.id,entityType:"activity"}}),i("q-dialog",{attrs:{persistent:""},model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"check",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Permanently delete this?")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{attrs:{flat:"",label:"DELETE FOREVER",color:"primary"},on:{click:t.deleteItem}})],1)],1)],1)],1)},l=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("q-chip",{attrs:{disable:t.emotion.important.disabled,selected:t.emotion.important.val,color:"primary",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.important,"val",e)},click:function(e){return t.updateEmotion("important")}}},[t._v("\n      "+t._s(t.emotion.important.num)+" Important\n    ")]),i("q-chip",{attrs:{disable:t.emotion.interesting.disabled,selected:t.emotion.interesting.val,color:"teal",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.interesting,"val",e)},click:function(e){return t.updateEmotion("interesting")}}},[t._v("\n      "+t._s(t.emotion.interesting.num)+" Interesting\n    ")]),i("q-chip",{attrs:{disable:t.emotion.fake.disabled,selected:t.emotion.fake.val,color:"orange",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.fake,"val",e)},click:function(e){return t.updateEmotion("fake")}}},[t._v("\n      "+t._s(t.emotion.fake.num)+" Fake\n    ")]),i("q-chip",{attrs:{disable:t.emotion.terrible.disabled,selected:t.emotion.terrible.val,color:"red",square:"","text-color":"white"},on:{"update:selected":function(e){return t.$set(t.emotion.terrible,"val",e)},click:function(e){return t.updateEmotion("terrible")}}},[t._v("\n      "+t._s(t.emotion.terrible.num)+" Terrible\n    ")])],1)},d=[],u={name:"EmotionPickerWidget",components:{},props:["emotions","activityId"],data(){return{emotion:{important:{num:0,val:!1,id:null,disabled:!1},interesting:{num:0,val:!1,id:null,disabled:!1},fake:{num:0,val:!1,id:null,disabled:!1},terrible:{num:0,val:!1,id:null,disabled:!1}}}},methods:{updateEmotion:function(t){this.emotion[t].disabled=!0,this.emotion[t].val?this.addEmotion(t):this.removeEmotion(t)},addEmotion:function(){var t=o()((function*(t){const e="https://concordant-api.herokuapp.com/activity-emotions",i={name:t,activity_id:this.activityId,creator_user_id:this.$store.state.user.uid};yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}).then(e=>{this.emotion[t].id=e.data.id,this.emotion[t].num++,this.emotion[t].disabled=!1}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving emotion: "+t})})}));return function(e){return t.apply(this,arguments)}}(),removeEmotion:function(){var t=o()((function*(t){const e="https://concordant-api.herokuapp.com/activity-emotions/"+this.emotion[t].id;yield this.$axios.delete(e).then(()=>{this.emotion[t].num--,this.emotion[t].disabled=!1}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving emotion: "+t})})}));return function(e){return t.apply(this,arguments)}}()},mounted(){if(this.emotions){const t=this;this.emotions.forEach((function(e){e.creator_user_id===t.$store.state.user.uid&&(t.emotion[e.name].val=!0,t.emotion[e.name].id=e.id),t.emotion[e.name].num=t.emotion[e.name].num+1}))}}},p=u,m=i("2877"),h=Object(m["a"])(p,c,d,!1,null,null,null),f=h.exports,g=i("9088"),v=i("c80c"),y=i("4729"),_={name:"ActivityCardItem",mixins:[v["a"],y["a"]],components:{CommentsWidget:g["a"],EmotionPickerWidget:f},props:["item","reload","entityId","entityType"],data(){return{confirmDelete:!1}},computed:{readyDate:function(){const t=this.item.create_date;return this.timeSince(t)},readyMessage:function(){return this.checkStr(this.item.message)}},methods:{deleteItem:function(){var t=o()((function*(){this.confirmDelete=!1;const t=this,e=["activity-comments","activity-emotions",""];e.forEach((function(i,a){console.log(a+1,e.length,a+1<e.length),t.deleteQuery(i,a+1===e.length)}))}));return function(){return t.apply(this,arguments)}}(),deleteQuery:function(){var t=o()((function*(t,e){const i=`https://concordant-api.herokuapp.com/activities/${this.item.id}/${t}`;yield this.$axios.delete(i).then(()=>{e&&(this.reload(),this.$q.notify({type:"positive",message:"Item deleted"}))}).catch(t=>{this.$q.notify({type:"negative",message:"Error deleting: "+t})})}));return function(e,i){return t.apply(this,arguments)}}(),promptDelete:function(){this.confirmDelete=!0}}},b=_,q=Object(m["a"])(b,r,l,!1,null,null,null),C=q.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"full-width"},[i("q-form",{on:{submit:t.postActivity}},[i("q-editor",{staticClass:"full-width bg-blue-grey-2",attrs:{flat:"",height:"100px","content-class":"bg-white-5","toolbar-text-color":"black","toolbar-toggle-color":"grey-8",placeholder:"What's up?","toolbar-bg":"grey-4",toolbar:[["bold","italic","underline"],[{label:t.$q.lang.editor.formatting,icon:t.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h3","h4","h5","h6","code"]}]]},model:{value:t.newActivity,callback:function(e){t.newActivity=e},expression:"newActivity"}}),i("div",{staticClass:"row"},[i("q-btn",{attrs:{type:"submit",color:"primary full-width"}},[t._v("submit")])],1)],1)],1)},k=[],w={name:"ActivityCreateWidget",props:["reload","entityType","entityId"],components:{},data(){return{newActivity:""}},methods:{postActivity:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/activities",e={creator_user_id:this.$store.state.user.uid,message:this.newActivity,entity_type:"activity"};"number"===typeof this.entity_id&&(e.entity_id=this.entityId),console.log(t),console.log(e),yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}),this.newActivity="",this.reload()}));return function(){return t.apply(this,arguments)}}()}},$=w,I=Object(m["a"])($,x,k,!1,null,null,null),z=I.exports,T={meta(){return{title:"string"===typeof this.title?this.title:"Activity"}},name:"ActivityListPage",components:{ActivityCreateWidget:z,ActivityCardItem:C},props:["entityId","entityType","title"],data(){return{items:[],pointer:0,limit:3,done:!1,loadNum:0,expanded:!1}},created(){this.getItems()},methods:{onIntersection:function(t,e){this.loadNum>1&&(this.pointer=this.pointer+this.limit,this.getItems()),this.loadNum++},reload:function(){this.pointer=0,this.done=!1,this.items=[],this.getItems()},getItems:function(){var t=o()((function*(){let t=`https://concordant-api.herokuapp.com/activities?filter[limit]=${this.limit}&filter[skip]=${this.pointer}&filter[include][0][relation]=creator&filter[include][1][relation]=emotions&filter[order]=create_date%20DESC`;t+="string"===typeof this.entityType?"&filter[where][and][2][entity_type]="+this.entityType:"",t+="number"===typeof this.entityId?"&filter[where][and][3][entity_id]="+this.entityId:"";const e=yield this.$axios.get(t);this.limit>e.data.length&&(this.done=!0),this.items=this.items.concat(e.data)}));return function(){return t.apply(this,arguments)}}()},mounted(){}},O=T,A=Object(m["a"])(O,a,s,!1,null,null,null);e["default"]=A.exports},9088:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("q-expansion-item",{staticClass:"bg-grey-trans",attrs:{"dense-toggle":"",icon:"comment",label:"Comments "+t.commentCount},on:{click:t.loadComments}},[i("div",{staticClass:"q-pa-md full-width"},[i("q-form",{on:{submit:t.postComment}},[i("q-input",{staticClass:"bg-grey-5",attrs:{filled:"",type:"textarea",required:"",autogrow:"",placeholder:"Type comment here"},model:{value:t.newComment,callback:function(e){t.newComment=e},expression:"newComment"}}),i("div",{staticClass:"row"},[i("q-space"),i("q-btn",{attrs:{type:"submit",color:"primary q-mt-lg"}},[t._v("submit")])],1)],1)],1),i("q-separator"),i("q-list",[t.comments.length?t._e():i("div",{staticClass:"text-center q-pa-lg"},[t._v("no comments")]),t._l(t.readyComments,(function(e){return i("q-item",{key:e.id,staticClass:"q-pl-lg q-pr-lg q-ma-sm",staticStyle:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},[i("q-item-section",{attrs:{top:"",avatar:""}},[i("q-avatar",{staticClass:"q-mr-md",attrs:{round:"",size:"75px"}},[i("img",{staticClass:"avatar",attrs:{round:"",src:e.creator.avatar_url}})])],1),i("q-item-section",[i("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.create_date))]),i("q-item-label",{staticClass:"text-h6"},[t._v(t._s(e.creator.name))]),i("q-item-label",{attrs:{lines:"10"},domProps:{innerHTML:t._s(e.text)}})],1),i("div",{staticClass:"float-right"},[t._v("\n           "+t._s(t.comment_likes_amounts[e.id])+" "),i("q-rating",{attrs:{max:"1",size:"1.75em",color:"red","color-selected":"red-12",icon:"favorite_border","icon-selected":"favorite","icon-half":"favorite","no-dimming":""},on:{click:function(i){return t.like(e.id)}},model:{value:t.comment_likes[e.id],callback:function(i){t.$set(t.comment_likes,e.id,i)},expression:"comment_likes[comment.id]"}})],1)],1)})),this.currentPointer+this.limit<=this.commentCount?i("q-btn",{staticClass:"full-width text-center",on:{click:t.showMore}},[t._v("show more")]):t._e()],2)],1)],1)},s=[],n=(i("fb6a"),i("c973")),o=i.n(n),r=i("b178"),l=i("c80c"),c={name:"CommentsWidget",created(){this.getCommentCount()},data(){return{comment_likes_amounts:{},comment_likes_obj:{},comment_likes:{},comments:[],newComment:"",currentPointer:0,limit:5,commentCount:"",loaded:!1}},mixins:[l["a"]],props:{entityId:{type:Number,required:!0},userOrganizationId:{type:Number,required:!1},entityType:{type:String,required:!0}},computed:{readyComments:function(){return this.comments.map(t=>(t.text=this.checkStr(t.text),t.create_date=r["b"].formatDate(t.create_date,"MMM Do, YYYY"),t))}},methods:{like:function(){var t=o()((function*(t){let e="",i="";const a=this.entityType+"_comment_id",s={creator_user_id:this.$store.state.user.uid,liked:this.comment_likes[t]};s[a]=t,"object"===typeof this.comment_likes_obj[t]?(e=`https://concordant-api.herokuapp.com/${this.entityType}-comment-likes/${this.comment_likes_obj[t][0].id}`,i="patch"):(e=`https://concordant-api.herokuapp.com/${this.entityType}-comment-likes`,i="post"),this.userOrganizationId&&(s.organization_id=this.userOrganizationId),console.log(e),console.log(s),yield this.$axios[i](e,s,{headers:{Accept:"application/json"}}).then(t=>{this.getComments(),this.$q.notify({type:"positive",message:"Update Success"})}).catch(t=>{this.$q.notify({type:"negative",message:"Error saving: "+t})})}));return function(e){return t.apply(this,arguments)}}(),setupLikes:function(){for(let t=0;t<this.comments.length;t++){const e="object"===typeof this.comments[t].likes?this.comments[t].likes.filter(t=>t.creator_user_id===this.$store.state.user.uid).map(t=>t.liked):[];this.comment_likes[this.comments[t].id]="number"===typeof e[e.length-1]?e[e.length-1]:0,this.comment_likes_amounts[this.comments[t].id]="object"===typeof this.comments[t].likes?this.comments[t].likes.filter(t=>1===t.liked).length:0,"object"===typeof this.comments[t].likes&&(this.comment_likes_obj[this.comments[t].id]=this.comments[t].likes.filter(t=>t.creator_user_id===this.$store.state.user.uid))}},loadComments:function(){this.loaded||(this.getComments(),this.loaded=!0)},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},getComments:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}-comments/?filter[skip]=${this.currentPointer}&filter[limit]=${this.limit}&filter[where][${this.entityType}_id]=${this.entityId}&filter[include][0][relation]=creator&filter[include][1][relation]=likes&filter[order]=create_date%20DESC`,e=yield this.$axios.get(t);this.comments=e.data,this.setupLikes()}));return function(){return t.apply(this,arguments)}}(),showMore:function(){var t=o()((function*(){this.currentPointer=this.currentPointer+this.limit;const t=`https://concordant-api.herokuapp.com/${this.entityType}-comments/?filter[skip]=${this.currentPointer}&filter[limit]=${this.limit}&filter[where][${this.entityType}_id]=${this.entityId}&filter[include][0][relation]=creator&filter[include][1][relation]=likes&filter[order]=create_date%20DESC`,e=yield this.$axios.get(t);this.comments=this.comments.concat(e.data)}));return function(){return t.apply(this,arguments)}}(),getCommentCount:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}-comments/count?[where][${this.entityType}_id]=${this.entityId}`,e=yield this.$axios.get(t);this.commentCount=e.data.count}));return function(){return t.apply(this,arguments)}}(),postComment:function(){var t=o()((function*(){const t=`https://concordant-api.herokuapp.com/${this.entityType}-comments`,e={creator_user_id:this.$store.state.user.uid,text:this.newComment};e[this.entityType+"_id"]=this.entityId,yield this.$axios.post(t,e,{headers:{Accept:"application/json"}}),this.newComment="",this.getComments(),this.getCommentCount()}));return function(){return t.apply(this,arguments)}}()}},d=c,u=i("2877"),p=Object(u["a"])(d,a,s,!1,null,null,null);e["a"]=p.exports},"95fb":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{attrs:{padding:""}},[i("q-form",[i("q-list",{staticClass:"full-width"},[i("q-list",[i("q-item-section",{staticClass:"full-width"},[t.conflictId?t._e():i("q-select",{staticClass:"q-mb-sm",attrs:{outlined:"",required:"","transition-show":"","use-input":"",autofocus:"","hide-selected":"","fill-input":"","input-debounce":"0",behavior:"menu","error-message":"","emit-value":"",label:"Conflict",options:t.options},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[t._v("\n                  No results\n                ")])],1)]},proxy:!0}],null,!1,3665793935),model:{value:t.conflictSelect,callback:function(e){t.conflictSelect=e},expression:"conflictSelect"}}),t.conflictId||t.userOrganizationIdSelect?t._e():i("div",{staticClass:"full-width q-mb-sm"},[i("q-expansion-item",{attrs:{"switch-toggle-side":"","dense-toggle":"",label:"Create Conflict"},model:{value:t.expanded,callback:function(e){t.expanded=e},expression:"expanded"}},[i("CreateConflictWidget",{attrs:{reload:t.loadConflicts}})],1)],1),t.userOrganizationNameSelect?i("p",{staticClass:"q-pt-none"},[t._v("Creating as: "+t._s(t.userOrganizationNameSelect))]):t._e(),i("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",required:"",label:"Name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),i("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",required:"",label:"Description"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),i("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",required:"",label:"Avatar URL"},model:{value:t.avatar_url,callback:function(e){t.avatar_url=e},expression:"avatar_url"}}),t._l(t.provisions,(function(e,a){return i("div",{key:a,staticClass:"q-mt-sm"},[i("q-separator"),i("div",{staticClass:"row"},[i("div",{staticClass:"col col-10"},[i("h6",{staticClass:"caption text-grey"},[t._v("Provision "+t._s(a+1))])]),i("div",{staticClass:"col text-right"},[i("q-btn",{staticClass:"q-mt-sm",attrs:{square:"",color:"grey",size:"12px",icon:"close"},on:{click:function(e){return t.removeProvision(a)}}})],1)]),i("q-input",{staticClass:"q-mb-sm",attrs:{required:"",filled:"",label:"Title"},model:{value:t.provisionNames[e],callback:function(i){t.$set(t.provisionNames,e,i)},expression:"provisionNames[count]"}}),i("q-input",{staticClass:"q-mb-sm",attrs:{type:"textarea",required:"",filled:"",label:"Provision Text"},model:{value:t.provisionText[e],callback:function(i){t.$set(t.provisionText,e,i)},expression:"provisionText[count]"}})],1)})),i("q-btn",{staticClass:"q-mb-sm",attrs:{color:"grey"},on:{click:t.addProvision}},[i("q-icon",{attrs:{left:"",size:"2em",name:"add"}}),i("div",[t._v("Add Provision")])],1),i("q-btn",{attrs:{color:"primary"},on:{click:t.postTreaty}},[i("div",[t._v("SUBMIT")])])],2)],1)],1)],1),i("q-dialog",{attrs:{persistent:""},model:{value:t.verify_org,callback:function(e){t.verify_org=e},expression:"verify_org"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center"},[i("q-avatar",{attrs:{icon:"done_outline",color:"primary","text-color":"white"}}),i("span",{staticClass:"q-ml-sm"},[t._v("Choose ONE organization to create as.")])],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_a.name,color:"primary"},on:{click:function(e){return t.setOrg("org_a")}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.org_b.name,color:"primary"},on:{click:function(e){return t.setOrg("org_b")}}})],1)],1)],1)],1)},s=[],n=(i("e01a"),i("c975"),i("a434"),i("c973")),o=i.n(n),r=i("156d"),l=i("cf1f"),c={name:"CreateTreaty",components:{CreateConflictWidget:r["a"]},props:["userOrganizationId","conflictId","reload"],data(){return{name:"",expanded:!1,achievementTypeId:null,avatar_url:"",conflict:null,conflicts:[],conflictsObj:{},conflictSelect:null,conflictSelectId:null,description:"",options:[],org_a:{name:"",id:""},org_b:{name:"",id:""},provisionCount:0,provisions:[],provisionNames:[],provisionText:[],userOrganizationIdSelect:null,userOrganizationNameSelect:null,verify_org:!1}},mixins:[l["a"]],created(){var t=this;return o()((function*(){t.conflictId||(t.getConflicts(),t.options=t.conflicts)}))()},watch:{conflictSelect:function(t){this.org_a.name=this.conflictsObj[t].org_a.name,this.org_b.name=this.conflictsObj[t].org_b.name,this.org_a.id=this.conflictsObj[t].org_a.id,this.org_b.id=this.conflictsObj[t].org_b.id,this.conflictSelectId=this.conflictsObj[t].id,this.verify_org=!0}},methods:{loadConflicts(t){this.getConflicts(),this.conflictSelect=t.data.name,this.expanded=!1},showLoading(){this.$q.loading.show({message:'This takes a while.<br/><span class="text-primary">Hang on...</span>'})},removeLoading(){this.$q.loading.hide()},setOrg(t){this.userOrganizationIdSelect=this[t].id,this.userOrganizationNameSelect=this[t].name},filterFn(t,e,i){e(""!==t?()=>{const e=t.toLocaleLowerCase();this.options=this.conflicts.filter(t=>t.toLocaleLowerCase().indexOf(e)>-1)}:()=>{this.options=this.conflicts})},setModel(t){this.conflict=t},getConflicts:function(){var t=o()((function*(){const t="https://concordant-api.herokuapp.com/conflicts?filter[order]=name%20ASC&filter[include][0][relation]=organization_a&filter[include][1][relation]=organization_b",e=yield this.$axios.get(t);this.conflicts=e.data.map(t=>t.name);for(var i=0,a=e.data.length;i<a;i++)this.conflictsObj[e.data[i].name]={id:e.data[i].id,org_a:e.data[i].organization_a,org_b:e.data[i].organization_b}}));return function(){return t.apply(this,arguments)}}(),postTreaty:function(){var t=o()((function*(){this.showLoading();const t="https://concordant-api.herokuapp.com/treaties",e=this.conflictId?this.conflictId:this.conflictSelectId,i=this.userOrganizationId?this.userOrganizationId:this.userOrganizationIdSelect,a={creator_user_id:this.$store.state.user.uid,organization_id:i,avatar_url:this.avatar_url,name:this.name,description:this.description,conflict_id:e,status_id:1};yield this.$axios.post(t,a,{headers:{Accept:"application/json"}}).then(t=>{this.postProvisions(t.data.id)}).catch(t=>{this.$q.notify({type:"negative",message:"Error creating treaty: "+t})})}));return function(){return t.apply(this,arguments)}}(),postProvisions:function(){var t=o()((function*(t){const e="https://concordant-api.herokuapp.com/treaty-provisions";let i={};this.provisionNames=this.provisionNames.filter(Object),this.provisionText=this.provisionText.filter(Object);for(let a=0;a<this.provisionNames.length;a++)i={treaty_id:t,creator_user_id:this.$store.state.user.uid,status_id:1,title:this.provisionNames[a],description:this.provisionText[a],position:a},yield this.$axios.post(e,i,{headers:{Accept:"application/json"}}).catch(t=>{this.$q.notify({type:"negative",message:"Error creating provision: "+t})}),this.provisionNames[a]="",this.provisionText[a]="";this.name="",this.description="",this.avatar_url="",this.$q.notify({type:"positive",message:"Treaty created!"}),this.addAchievement("Treaty Builder"),this.removeLoading(),this.reload()}));return function(e){return t.apply(this,arguments)}}(),removeProvision:function(t){this.provisions.splice(t,1)},addProvision:function(){this.provisionCount++,this.provisions.push(this.provisionCount)}},mounted(){}},d=c,u=i("2877"),p=Object(u["a"])(d,a,s,!1,null,null,null);e["a"]=p.exports},c80c:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},s=[],n=(i("c975"),i("5319"),{name:"TextToolsMixin",methods:{checkStr:function(t){let e=this.stripTags(t);return e=this.ytCheck(e),e=this.imageUrlCheck(e),e=this.unsplashUrlCheck(e),e=this.linkCheck(e),e},ytCheck:function(t){const e=t.match(/(http:|https:)?(\/\/)?(www\.)?(youtube.com|youtu.be)\/(watch|embed)?(\?v=|\/)?(\S+)?/),i='<iframe type="text/html" width="480" height="320" src="https://www.youtube.com/embed/embed_code_target" frameborder="0"></iframe>';return e?t.replace(e[0],(function(t,a){return i.replace("embed_code_target",e[7].split("&")[0])})):t},stripTags:function(t){return t.replaceAll("<script>","")},imageUrlCheck:function(t){const e=/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|gif|png)/gi,i=t.replace(e,(function(t){return'<img src="'+t+'" style="max-width:100%;" />'}));return i},unsplashUrlCheck:function(t){const e=/(https?:\/\/(.+?\.)?images.unsplash\.com(\/[A-Za-z0-9\-._~:?#[\]@!$&'()*+,;=]*)?)/g,i=t.replace(e,(function(t){return'<img src="'+t+'" style="max-width:100%;" />'}));return i},linkCheck:function(t){function e(t){const e=["youtube","youtu","images.unsplash",".jpg",".jpeg",".gif",".png",".webp"];for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1}const i=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)(?!png|gif|jpg)/g,a=t.replace(i,(function(t){return e(t)?t:'<a target="_blank" href="'+t+'" />'+t+"</a>"}));return a}}}),o=n,r=i("2877"),l=Object(r["a"])(o,a,s,!1,null,null,null);e["a"]=l.exports},cf1f:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},s=[],n=i("c973"),o=i.n(n),r={name:"AddAchievementMixin",methods:{addAchievement:function(){var t=o()((function*(t){let e="https://concordant-api.herokuapp.com/achievement-types?filter[where][name]="+t;const i=yield this.$axios.get(e);this.achievementTypeId=i.data[0].id;const a={owner_user_id:this.$store.state.user.uid,achievement_type_id:this.achievementTypeId};e="https://concordant-api.herokuapp.com/user-achievements",yield this.$axios.post(e,a,{headers:{Accept:"application/json"}}).then(e=>{this.$q.notify({type:"positive",message:"You received new Achievement: "+t})}).catch(t=>{this.$q.notify({type:"negative",message:"Error creating: "+t})})}));return function(e){return t.apply(this,arguments)}}()},mounted(){}},l=r,c=i("2877"),d=Object(c["a"])(l,a,s,!1,null,null,null);e["a"]=d.exports}}]);